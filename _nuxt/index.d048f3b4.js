import{b as he,d as P}from"./runtime.ca6a5e5a.js";import{m as Z}from"./typescript.c44ade1c.js";import{i as Pe}from"./icon.13fbe947.js";import{b as q,e as re,Z as be,R as Ee,h as H,aB as Fe,aH as Re,E as je,i as te,l as Ke,f as pe,a1 as Ve,o as F,j as ue,m as xe,u as l,c as ee,w as _e,O as $e,k as X,z as ie,P as ge,v as Ye,Q as we,$ as Ge,p as Ne,t as Ue}from"./entry.b33cb278.js";import{ElIcon as Xe}from"./index.960dedfd.js";import{CaretRight as qe}from"./index.dc3cf8fc.js";import{ElCheckbox as Je}from"./index.2ba28698.js";import{_ as Se}from"./plugin-vue_export-helper.b0b5f2d9.js";import{a as Qe}from"./constants.e2ce9b61.js";import{u as Ze}from"./index.fd65d236.js";import{F as We}from"./fixed-size-list.d64dfcda.js";import{w as et}from"./install.187cf5b6.js";import"./types.bb628c62.js";import"./style.6fe07f58.js";import"./index.3ddc1a68.js";import"./size.007424cf.js";import"./event.e54e7e4a.js";import"./use-form-common-props.a25456a0.js";import"./use-form-item.ec62bf83.js";import"./error.6c36bb34.js";import"./isEqual.f785ded9.js";import"./_Uint8Array.4a2b558d.js";import"./_baseGet.57648035.js";import"./isArray.3fa80ba1.js";import"./isObject.5a18b265.js";import"./_arrayPush.6d7e61e4.js";import"./_isIndex.f5af1eca.js";import"./pick.b27c0e8e.js";import"./_baseSet.39436bc7.js";import"./_defineProperty.f71786e5.js";import"./flatten.a5c62c9e.js";import"./_baseFlatten.02332558.js";import"./_overRest.e23153e9.js";import"./get.070bcf83.js";import"./scrollbar.dc8979ee.js";import"./util.c8753e63.js";import"./raf.77fcd12d.js";import"./browser.c687ae44.js";const ke=Symbol(),tt={key:-1,level:-1,data:{}};var W=(t=>(t.KEY="id",t.LABEL="label",t.CHILDREN="children",t.DISABLED="disabled",t))(W||{}),fe=(t=>(t.ADD="add",t.DELETE="delete",t))(fe||{});const De={type:Number,default:26},nt=he({data:{type:P(Array),default:()=>Z([])},emptyText:{type:String},height:{type:Number,default:200},props:{type:P(Object),default:()=>Z({children:"children",label:"label",disabled:"disabled",value:"id"})},highlightCurrent:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},defaultCheckedKeys:{type:P(Array),default:()=>Z([])},checkStrictly:{type:Boolean,default:!1},defaultExpandedKeys:{type:P(Array),default:()=>Z([])},indent:{type:Number,default:16},itemSize:De,icon:{type:Pe},expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:{type:Boolean,default:!1},currentNodeKey:{type:P([String,Number])},accordion:{type:Boolean,default:!1},filterMethod:{type:P(Function)},perfMode:{type:Boolean,default:!0}}),ot=he({node:{type:P(Object),default:()=>Z(tt)},expanded:{type:Boolean,default:!1},checked:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},current:{type:Boolean,default:!1},hiddenExpandIcon:{type:Boolean,default:!1},itemSize:De}),at=he({node:{type:P(Object),required:!0}}),Te="node-click",Le="node-expand",Be="node-collapse",Ie="current-change",Me="check",He="check-change",Oe="node-contextmenu",lt={[Te]:(t,n,d)=>t&&n&&d,[Le]:(t,n)=>t&&n,[Be]:(t,n)=>t&&n,[Ie]:(t,n)=>t&&n,[Me]:(t,n)=>t&&n,[He]:(t,n)=>t&&typeof n=="boolean",[Oe]:(t,n,d)=>t&&n&&d},st={click:(t,n)=>!!(t&&n),toggle:t=>!!t,check:(t,n)=>t&&typeof n=="boolean"};function dt(t,n){const d=q(new Set),s=q(new Set),{emit:c}=Ee();re([()=>n.value,()=>t.defaultCheckedKeys],()=>be(()=>{_(t.defaultCheckedKeys)}),{immediate:!0});const K=()=>{if(!n.value||!t.showCheckbox||t.checkStrictly)return;const{levelTreeNodeMap:a,maxLevel:r}=n.value,u=d.value,f=new Set;for(let h=r-1;h>=1;--h){const C=a.get(h);!C||C.forEach(g=>{const w=g.children;if(w){let I=!0,j=!1;for(const $ of w){const Y=$.key;if(u.has(Y))j=!0;else if(f.has(Y)){I=!1,j=!0;break}else I=!1}I?u.add(g.key):j?(f.add(g.key),u.delete(g.key)):(u.delete(g.key),f.delete(g.key))}})}s.value=f},E=a=>d.value.has(a.key),p=a=>s.value.has(a.key),N=(a,r,u=!0)=>{const f=d.value,h=(C,g)=>{f[g?fe.ADD:fe.DELETE](C.key);const w=C.children;!t.checkStrictly&&w&&w.forEach(I=>{I.disabled||h(I,g)})};h(a,r),K(),u&&x(a,r)},x=(a,r)=>{const{checkedNodes:u,checkedKeys:f}=k(),{halfCheckedNodes:h,halfCheckedKeys:C}=y();c(Me,a.data,{checkedKeys:f,checkedNodes:u,halfCheckedKeys:C,halfCheckedNodes:h}),c(He,a.data,r)};function B(a=!1){return k(a).checkedKeys}function o(a=!1){return k(a).checkedNodes}function m(){return y().halfCheckedKeys}function b(){return y().halfCheckedNodes}function k(a=!1){const r=[],u=[];if((n==null?void 0:n.value)&&t.showCheckbox){const{treeNodeMap:f}=n.value;d.value.forEach(h=>{const C=f.get(h);C&&(!a||a&&C.isLeaf)&&(u.push(h),r.push(C.data))})}return{checkedKeys:u,checkedNodes:r}}function y(){const a=[],r=[];if((n==null?void 0:n.value)&&t.showCheckbox){const{treeNodeMap:u}=n.value;s.value.forEach(f=>{const h=u.get(f);h&&(r.push(f),a.push(h.data))})}return{halfCheckedNodes:a,halfCheckedKeys:r}}function R(a){d.value.clear(),s.value.clear(),_(a)}function v(a,r){if((n==null?void 0:n.value)&&t.showCheckbox){const u=n.value.treeNodeMap.get(a);u&&N(u,r,!1)}}function _(a){if(n!=null&&n.value){const{treeNodeMap:r}=n.value;if(t.showCheckbox&&r&&a)for(const u of a){const f=r.get(u);f&&!E(f)&&N(f,!0,!1)}}}return{updateCheckedKeys:K,toggleCheckbox:N,isChecked:E,isIndeterminate:p,getCheckedKeys:B,getCheckedNodes:o,getHalfCheckedKeys:m,getHalfCheckedNodes:b,setChecked:v,setCheckedKeys:R}}function ct(t,n){const d=q(new Set([])),s=q(new Set([])),c=H(()=>Fe(t.filterMethod));function K(p){var N;if(!c.value)return;const x=new Set,B=s.value,o=d.value,m=[],b=((N=n.value)==null?void 0:N.treeNodes)||[],k=t.filterMethod;o.clear();function y(R){R.forEach(v=>{m.push(v),k!=null&&k(p,v.data)?m.forEach(a=>{x.add(a.key)}):v.isLeaf&&o.add(v.key);const _=v.children;if(_&&y(_),!v.isLeaf){if(!x.has(v.key))o.add(v.key);else if(_){let a=!0;for(const r of _)if(!o.has(r.key)){a=!1;break}a?B.add(v.key):B.delete(v.key)}}m.pop()})}return y(b),x}function E(p){return s.value.has(p.key)}return{hiddenExpandIconKeySet:s,hiddenNodeKeySet:d,doFilter:K,isForceHiddenExpandIcon:E}}function it(t,n){const d=q(new Set(t.defaultExpandedKeys)),s=q(),c=Re();re(()=>t.currentNodeKey,e=>{s.value=e},{immediate:!0}),re(()=>t.data,e=>{ve(e)},{immediate:!0});const{isIndeterminate:K,isChecked:E,toggleCheckbox:p,getCheckedKeys:N,getCheckedNodes:x,getHalfCheckedKeys:B,getHalfCheckedNodes:o,setChecked:m,setCheckedKeys:b}=dt(t,c),{doFilter:k,hiddenNodeKeySet:y,isForceHiddenExpandIcon:R}=ct(t,c),v=H(()=>{var e;return((e=t.props)==null?void 0:e.value)||W.KEY}),_=H(()=>{var e;return((e=t.props)==null?void 0:e.children)||W.CHILDREN}),a=H(()=>{var e;return((e=t.props)==null?void 0:e.disabled)||W.DISABLED}),r=H(()=>{var e;return((e=t.props)==null?void 0:e.label)||W.LABEL}),u=H(()=>{const e=d.value,i=y.value,D=[],O=c.value&&c.value.treeNodes||[];function V(){const G=[];for(let T=O.length-1;T>=0;--T)G.push(O[T]);for(;G.length;){const T=G.pop();if(!!T&&(i.has(T.key)||D.push(T),e.has(T.key))){const L=T.children;if(L){const ce=L.length;for(let U=ce-1;U>=0;--U)G.push(L[U])}}}}return V(),D}),f=H(()=>u.value.length>0);function h(e){const i=new Map,D=new Map;let O=1;function V(T,L=1,ce=void 0){var U;const me=[];for(const J of T){const Ce=w(J),A={level:L,key:Ce,data:J};A.label=j(J),A.parent=ce;const Q=g(J);A.disabled=I(J),A.isLeaf=!Q||Q.length===0,Q&&Q.length&&(A.children=V(Q,L+1,A)),me.push(A),i.set(Ce,A),D.has(L)||D.set(L,[]),(U=D.get(L))==null||U.push(A)}return L>O&&(O=L),me}const G=V(e);return{treeNodeMap:i,levelTreeNodeMap:D,maxLevel:O,treeNodes:G}}function C(e){const i=k(e);i&&(d.value=i)}function g(e){return e[_.value]}function w(e){return e?e[v.value]:""}function I(e){return e[a.value]}function j(e){return e[r.value]}function $(e){d.value.has(e.key)?z(e):ne(e)}function Y(e){d.value=new Set(e)}function ae(e,i){n(Te,e.data,e,i),le(e),t.expandOnClickNode&&$(e),t.showCheckbox&&t.checkOnClickNode&&!e.disabled&&p(e,!E(e),!0)}function le(e){S(e)||(s.value=e.key,n(Ie,e.data,e))}function se(e,i){p(e,i)}function ne(e){const i=d.value;if(c.value&&t.accordion){const{treeNodeMap:D}=c.value;i.forEach(O=>{const V=D.get(O);e&&e.level===(V==null?void 0:V.level)&&i.delete(O)})}i.add(e.key),n(Le,e.data,e)}function z(e){d.value.delete(e.key),n(Be,e.data,e)}function ye(e){return d.value.has(e.key)}function oe(e){return!!e.disabled}function S(e){const i=s.value;return!!i&&i===e.key}function M(){var e,i;if(!!s.value)return(i=(e=c.value)==null?void 0:e.treeNodeMap.get(s.value))==null?void 0:i.data}function de(){return s.value}function Ae(e){s.value=e}function ve(e){be(()=>c.value=h(e))}function ze(e){var i;const D=je(e)?w(e):e;return(i=c.value)==null?void 0:i.treeNodeMap.get(D)}return{tree:c,flattenTree:u,isNotEmpty:f,getKey:w,getChildren:g,toggleExpand:$,toggleCheckbox:p,isExpanded:ye,isChecked:E,isIndeterminate:K,isDisabled:oe,isCurrent:S,isForceHiddenExpandIcon:R,handleNodeClick:ae,handleNodeCheck:se,getCurrentNode:M,getCurrentKey:de,setCurrentKey:Ae,getCheckedKeys:N,getCheckedNodes:x,getHalfCheckedKeys:B,getHalfCheckedNodes:o,setChecked:m,setCheckedKeys:b,filter:C,setData:ve,getNode:ze,expandNode:ne,collapseNode:z,setExpandedKeys:Y}}var rt=te({name:"ElTreeNodeContent",props:at,setup(t){const n=Ke(ke),d=pe("tree");return()=>{const s=t.node,{data:c}=s;return n!=null&&n.ctx.slots.default?n.ctx.slots.default({node:s,data:c}):Ve("span",{class:d.be("node","label")},[s==null?void 0:s.label])}}});const ut=["aria-expanded","aria-disabled","aria-checked","data-key","onClick"],ft=te({name:"ElTreeNode"}),ht=te({...ft,props:ot,emits:st,setup(t,{emit:n}){const d=t,s=Ke(ke),c=pe("tree"),K=H(()=>{var o;return(o=s==null?void 0:s.props.indent)!=null?o:16}),E=H(()=>{var o;return(o=s==null?void 0:s.props.icon)!=null?o:qe}),p=o=>{n("click",d.node,o)},N=()=>{n("toggle",d.node)},x=o=>{n("check",d.node,o)},B=o=>{var m,b,k,y;(k=(b=(m=s==null?void 0:s.instance)==null?void 0:m.vnode)==null?void 0:b.props)!=null&&k.onNodeContextmenu&&(o.stopPropagation(),o.preventDefault()),s==null||s.ctx.emit(Oe,o,(y=d.node)==null?void 0:y.data,d.node)};return(o,m)=>{var b,k,y;return F(),ue("div",{ref:"node$",class:X([l(c).b("node"),l(c).is("expanded",o.expanded),l(c).is("current",o.current),l(c).is("focusable",!o.disabled),l(c).is("checked",!o.disabled&&o.checked)]),role:"treeitem",tabindex:"-1","aria-expanded":o.expanded,"aria-disabled":o.disabled,"aria-checked":o.checked,"data-key":(b=o.node)==null?void 0:b.key,onClick:ie(p,["stop"]),onContextmenu:B},[xe("div",{class:X(l(c).be("node","content")),style:we({paddingLeft:`${(o.node.level-1)*l(K)}px`,height:o.itemSize+"px"})},[l(E)?(F(),ee(l(Xe),{key:0,class:X([l(c).is("leaf",!!((k=o.node)!=null&&k.isLeaf)),l(c).is("hidden",o.hiddenExpandIcon),{expanded:!((y=o.node)!=null&&y.isLeaf)&&o.expanded},l(c).be("node","expand-icon")]),onClick:ie(N,["stop"])},{default:_e(()=>[(F(),ee($e(l(E))))]),_:1},8,["class","onClick"])):ge("v-if",!0),o.showCheckbox?(F(),ee(l(Je),{key:1,"model-value":o.checked,indeterminate:o.indeterminate,disabled:o.disabled,onChange:x,onClick:m[0]||(m[0]=ie(()=>{},["stop"]))},null,8,["model-value","indeterminate","disabled"])):ge("v-if",!0),Ye(l(rt),{node:o.node},null,8,["node"])],6)],42,ut)}}});var pt=Se(ht,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-v2/src/tree-node.vue"]]);const kt=te({name:"ElTreeV2"}),yt=te({...kt,props:nt,emits:lt,setup(t,{expose:n,emit:d}){const s=t,c=Ge(),K=H(()=>s.itemSize);Ne(ke,{ctx:{emit:d,slots:c},props:s,instance:Ee()}),Ne(Qe,void 0);const{t:E}=Ze(),p=pe("tree"),{flattenTree:N,isNotEmpty:x,toggleExpand:B,isExpanded:o,isIndeterminate:m,isChecked:b,isDisabled:k,isCurrent:y,isForceHiddenExpandIcon:R,handleNodeClick:v,handleNodeCheck:_,toggleCheckbox:a,getCurrentNode:r,getCurrentKey:u,setCurrentKey:f,getCheckedKeys:h,getCheckedNodes:C,getHalfCheckedKeys:g,getHalfCheckedNodes:w,setChecked:I,setCheckedKeys:j,filter:$,setData:Y,getNode:ae,expandNode:le,collapseNode:se,setExpandedKeys:ne}=it(s,d);return n({toggleCheckbox:a,getCurrentNode:r,getCurrentKey:u,setCurrentKey:f,getCheckedKeys:h,getCheckedNodes:C,getHalfCheckedKeys:g,getHalfCheckedNodes:w,setChecked:I,setCheckedKeys:j,filter:$,setData:Y,getNode:ae,expandNode:le,collapseNode:se,setExpandedKeys:ne}),(z,ye)=>{var oe;return F(),ue("div",{class:X([l(p).b(),{[l(p).m("highlight-current")]:z.highlightCurrent}]),role:"tree"},[l(x)?(F(),ee(l(We),{key:0,"class-name":l(p).b("virtual-list"),data:l(N),total:l(N).length,height:z.height,"item-size":l(K),"perf-mode":z.perfMode},{default:_e(({data:S,index:M,style:de})=>[(F(),ee(pt,{key:S[M].key,style:we(de),node:S[M],expanded:l(o)(S[M]),"show-checkbox":z.showCheckbox,checked:l(b)(S[M]),indeterminate:l(m)(S[M]),"item-size":l(K),disabled:l(k)(S[M]),current:l(y)(S[M]),"hidden-expand-icon":l(R)(S[M]),onClick:l(v),onToggle:l(B),onCheck:l(_)},null,8,["style","node","expanded","show-checkbox","checked","indeterminate","item-size","disabled","current","hidden-expand-icon","onClick","onToggle","onCheck"]))]),_:1},8,["class-name","data","total","height","item-size","perf-mode"])):(F(),ue("div",{key:1,class:X(l(p).e("empty-block"))},[xe("span",{class:X(l(p).e("empty-text"))},Ue((oe=z.emptyText)!=null?oe:l(E)("el.tree.emptyText")),3)],2))],2)}}});var vt=Se(yt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-v2/src/tree.vue"]]);const nn=et(vt);export{nn as ElTreeV2,nn as default};
