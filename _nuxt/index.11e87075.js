import{ElSelect as S,ElOption as w,selectKey as F}from"./index.37a58d78.js";import M from"./index.ef016688.js";import{f as R,a2 as H,h as v,Z as _,i as L,R as U,e as I,aC as z,l as W,b as P,ai as V,S as Z,a1 as x}from"./entry.7f953a48.js";import{p as E}from"./pick.b27c0e8e.js";import{U as A}from"./event.e54e7e4a.js";import{i as $}from"./isEqual.f785ded9.js";import{_ as D}from"./plugin-vue_export-helper.b0b5f2d9.js";import"./index.30f9c5c6.js";import"./index.2837b29c.js";import"./runtime.7bbd0ea7.js";import"./types.6589216f.js";import"./index.e0cee20e.js";import"./constants.e2ce9b61.js";import"./focus-trap.daca3e80.js";import"./aria.362daa0e.js";import"./install.eb991fcc.js";import"./index.ffd54757.js";import"./index.fbf6b4c2.js";import"./style.63c3403a.js";import"./index.597e0eaa.js";import"./browser.d1f1569e.js";import"./index.f298a15c.js";import"./size.007424cf.js";import"./icon.577a7726.js";import"./typescript.c44ade1c.js";import"./index.a9f5a16d.js";import"./use-form-item.dcfc827e.js";import"./use-form-common-props.5d54d907.js";import"./error.6c36bb34.js";import"./i18n.de31208d.js";import"./index.5c4ee287.js";import"./event.079378dc.js";import"./index.80bafb5b.js";import"./util.c8753e63.js";import"./index.ccfe103f.js";import"./strings.bdfeda91.js";import"./get.070bcf83.js";import"./_baseGet.57648035.js";import"./isArray.3fa80ba1.js";import"./isObject.5a18b265.js";import"./index.80475980.js";import"./index.59e17544.js";import"./scroll.2b6fcfe4.js";import"./debounce.a43f57fe.js";import"./index.55cf4f11.js";import"./validator.f60c176b.js";import"./_Uint8Array.4a2b558d.js";import"./_arrayPush.6d7e61e4.js";import"./_isIndex.f5af1eca.js";import"./index.3d1b8f39.js";import"./index.d8dfc1ef.js";import"./_baseSet.39436bc7.js";import"./_defineProperty.f71786e5.js";import"./flatten.a5c62c9e.js";import"./_baseFlatten.02332558.js";import"./_overRest.e23153e9.js";const G=(e,{attrs:o},{tree:a,key:d})=>{const r=R("tree-select"),i={...E(H(e),Object.keys(S.props)),...o,valueKey:d,popperClass:v(()=>{const c=[r.e("popper")];return e.popperClass&&c.push(e.popperClass),c.join(" ")}),filterMethod:(c="")=>{e.filterMethod&&e.filterMethod(c),_(()=>{var m;(m=a.value)==null||m.filter(c)})},onVisibleChange:c=>{var m;(m=o.onVisibleChange)==null||m.call(o,c),e.filterable&&c&&i.filterMethod()}};return i},J=L({extends:w,setup(e,o){const a=w.setup(e,o);delete a.selectOptionClick;const d=U().proxy;return _(()=>{a.select.cachedOptions.get(d.value)||a.select.onOptionCreate(d)}),a},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function T(e){return e||e===0}function j(e){return Array.isArray(e)&&e.length}function K(e){return Array.isArray(e)?e:T(e)?[e]:[]}function b(e,o,a,d,r){for(let i=0;i<e.length;i++){const c=e[i];if(o(c,i,e,r))return d?d(c,i,e,r):c;{const m=a(c);if(j(m)){const n=b(m,o,a,d,c);if(n)return n}}}}function q(e,o,a,d){for(let r=0;r<e.length;r++){const i=e[r];o(i,r,e,d);const c=a(i);j(c)&&q(c,o,a,i)}}const Q=(e,{attrs:o,slots:a,emit:d},{select:r,tree:i,key:c})=>{I(()=>e.modelValue,()=>{e.showCheckbox&&_(()=>{const t=i.value;t&&!$(t.getCheckedKeys(),K(e.modelValue))&&t.setCheckedKeys(K(e.modelValue))})},{immediate:!0,deep:!0});const m=v(()=>({value:c.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),n=(t,l)=>{var s;const u=m.value[t];return z(u)?u(l,(s=i.value)==null?void 0:s.getNode(n("value",l))):l[u]},g=K(e.modelValue).map(t=>b(e.data||[],l=>n("value",l)===t,l=>n("children",l),(l,s,u,p)=>p&&n("value",p))).filter(t=>T(t)),y=v(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const t=[];return q(e.data.concat(e.cacheData),l=>{const s=n("value",l);t.push({value:s,currentLabel:n("label",l),isDisabled:n("disabled",l)})},l=>n("children",l)),t}),C=v(()=>y.value.reduce((t,l)=>({...t,[l.value]:l}),{}));return{...E(H(e),Object.keys(M.props)),...o,nodeKey:c,expandOnClickNode:v(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:v(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(g):g),renderContent:(t,{node:l,data:s,store:u})=>t(J,{value:n("value",s),label:n("label",s),disabled:n("disabled",s)},e.renderContent?()=>e.renderContent(t,{node:l,data:s,store:u}):a.default?()=>a.default({node:l,data:s,store:u}):void 0),filterNodeMethod:(t,l,s)=>{var u;return e.filterNodeMethod?e.filterNodeMethod(t,l,s):t?(u=n("label",l))==null?void 0:u.includes(t):!0},onNodeClick:(t,l,s)=>{var u,p,k;if((u=o.onNodeClick)==null||u.call(o,t,l,s),!(e.showCheckbox&&e.checkOnClickNode))if(!e.showCheckbox&&(e.checkStrictly||l.isLeaf)){if(!n("disabled",t)){const f=(p=r.value)==null?void 0:p.options.get(n("value",t));(k=r.value)==null||k.handleOptionSelect(f)}}else e.expandOnClickNode&&s.proxy.handleExpandIconClick()},onCheck:(t,l)=>{if(!e.showCheckbox)return;const s=n("value",t),u=l.checkedKeys,p=e.multiple?K(e.modelValue).filter(f=>f in C.value&&!i.value.getNode(f)&&!u.includes(f)):[],k=u.concat(p);if(e.checkStrictly)d(A,e.multiple?k:k.includes(s)?s:void 0);else if(e.multiple)d(A,i.value.getCheckedKeys(!0));else{const f=b([t],h=>!j(n("children",h))&&!n("disabled",h),h=>n("children",h)),N=f?n("value",f):void 0,B=T(e.modelValue)&&!!b([t],h=>n("value",h)===e.modelValue,h=>n("children",h));d(A,N===e.modelValue||B?void 0:N)}_(()=>{var f;const N=K(e.modelValue);i.value.setCheckedKeys(N),(f=o.onCheck)==null||f.call(o,t,{checkedKeys:i.value.getCheckedKeys(),checkedNodes:i.value.getCheckedNodes(),halfCheckedKeys:i.value.getHalfCheckedKeys(),halfCheckedNodes:i.value.getHalfCheckedNodes()})})},cacheOptions:y}};var X=L({props:{data:{type:Array,default:()=>[]}},setup(e){const o=W(F);return I(()=>e.data,()=>{var a;e.data.forEach(r=>{o.cachedOptions.has(r.value)||o.cachedOptions.set(r.value,r)});const d=((a=o.selectWrapper)==null?void 0:a.querySelectorAll("input"))||[];Array.from(d).includes(document.activeElement)||o.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const Y=L({name:"ElTreeSelect",inheritAttrs:!1,props:{...S.props,...M.props,cacheData:{type:Array,default:()=>[]}},setup(e,o){const{slots:a,expose:d}=o,r=P(),i=P(),c=v(()=>e.nodeKey||e.valueKey||"value"),m=G(e,o,{select:r,tree:i,key:c}),{cacheOptions:n,...g}=Q(e,o,{select:r,tree:i,key:c}),y=V({});return d(y),Z(()=>{Object.assign(y,{...E(i.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...E(r.value,["focus","blur"])})}),()=>x(S,V({...m,ref:C=>r.value=C}),{...a,default:()=>[x(X,{data:n.value}),x(M,V({...g,ref:C=>i.value=C}))]})}});var O=D(Y,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-select/src/tree-select.vue"]]);O.install=e=>{e.component(O.name,O)};const ee=O,it=ee;export{it as ElTreeSelect,ee as default};
