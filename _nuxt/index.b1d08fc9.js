import{ElSelect as M,ElOption as j,selectKey as F}from"./index.a766ca91.js";import S from"./index.50dc8c46.js";import{a2 as U,t as P,k as v,e as _,f as w,x as z,w as I,aw as R,a5 as W,p as H,M as E,H as $,j as V}from"./entry.40f94ce2.js";import{p as x}from"./pick.b27c0e8e.js";import{U as A}from"./event.e54e7e4a.js";import{i as D}from"./isEqual.f785ded9.js";import{_ as G}from"./plugin-vue_export-helper.b0b5f2d9.js";import"./index.5dbd068b.js";import"./index.cd7da693.js";import"./runtime.a8d5aa72.js";import"./types.0ffe2429.js";import"./index.1eb5ee59.js";import"./constants.e2ce9b61.js";import"./focus-trap.efed23b5.js";import"./aria.362daa0e.js";import"./install.db378abc.js";import"./index.ecd8b7b6.js";import"./index.52232a07.js";import"./style.a7bf22e4.js";import"./index.e0b44930.js";import"./browser.d39506a1.js";import"./index.f72caa6f.js";import"./size.007424cf.js";import"./icon.aaa9d058.js";import"./typescript.c44ade1c.js";import"./index.43dcf301.js";import"./use-form-item.eeb4683c.js";import"./use-form-common-props.c0d2009e.js";import"./error.6c36bb34.js";import"./i18n.de31208d.js";import"./index.0becfcd2.js";import"./event.079378dc.js";import"./index.8ce59d4c.js";import"./util.c8753e63.js";import"./index.b3d93e3d.js";import"./strings.c93dd47f.js";import"./get.070bcf83.js";import"./_baseGet.57648035.js";import"./isArray.3fa80ba1.js";import"./isObject.5a18b265.js";import"./index.b1f4efad.js";import"./index.d26d92fd.js";import"./scroll.123f6305.js";import"./debounce.a43f57fe.js";import"./index.4cc18b4f.js";import"./validator.f60c176b.js";import"./_Uint8Array.4a2b558d.js";import"./_arrayPush.6d7e61e4.js";import"./_isIndex.f5af1eca.js";import"./index.f5add79d.js";import"./index.b287272e.js";import"./_baseSet.39436bc7.js";import"./_defineProperty.f71786e5.js";import"./flatten.a5c62c9e.js";import"./_baseFlatten.02332558.js";import"./_overRest.e23153e9.js";const J=(e,{attrs:i},{tree:a,key:d})=>{const r=U("tree-select"),o={...x(P(e),Object.keys(M.props)),...i,valueKey:d,popperClass:v(()=>{const c=[r.e("popper")];return e.popperClass&&c.push(e.popperClass),c.join(" ")}),filterMethod:(c="")=>{e.filterMethod&&e.filterMethod(c),_(()=>{var m;(m=a.value)==null||m.filter(c)})},onVisibleChange:c=>{var m;(m=i.onVisibleChange)==null||m.call(i,c),e.filterable&&c&&o.filterMethod()}};return o},Q=w({extends:j,setup(e,i){const a=j.setup(e,i);delete a.selectOptionClick;const d=z().proxy;return _(()=>{a.select.cachedOptions.get(d.value)||a.select.onOptionCreate(d)}),a},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function T(e){return e||e===0}function L(e){return Array.isArray(e)&&e.length}function K(e){return Array.isArray(e)?e:T(e)?[e]:[]}function b(e,i,a,d,r){for(let o=0;o<e.length;o++){const c=e[o];if(i(c,o,e,r))return d?d(c,o,e,r):c;{const m=a(c);if(L(m)){const n=b(m,i,a,d,c);if(n)return n}}}}function q(e,i,a,d){for(let r=0;r<e.length;r++){const o=e[r];i(o,r,e,d);const c=a(o);L(c)&&q(c,i,a,o)}}const X=(e,{attrs:i,slots:a,emit:d},{select:r,tree:o,key:c})=>{I(()=>e.modelValue,()=>{e.showCheckbox&&_(()=>{const t=o.value;t&&!D(t.getCheckedKeys(),K(e.modelValue))&&t.setCheckedKeys(K(e.modelValue))})},{immediate:!0,deep:!0});const m=v(()=>({value:c.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),n=(t,l)=>{var s;const u=m.value[t];return R(u)?u(l,(s=o.value)==null?void 0:s.getNode(n("value",l))):l[u]},g=K(e.modelValue).map(t=>b(e.data||[],l=>n("value",l)===t,l=>n("children",l),(l,s,u,p)=>p&&n("value",p))).filter(t=>T(t)),y=v(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const t=[];return q(e.data.concat(e.cacheData),l=>{const s=n("value",l);t.push({value:s,currentLabel:n("label",l),isDisabled:n("disabled",l)})},l=>n("children",l)),t}),C=v(()=>y.value.reduce((t,l)=>({...t,[l.value]:l}),{}));return{...x(P(e),Object.keys(S.props)),...i,nodeKey:c,expandOnClickNode:v(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:v(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(g):g),renderContent:(t,{node:l,data:s,store:u})=>t(Q,{value:n("value",s),label:n("label",s),disabled:n("disabled",s)},e.renderContent?()=>e.renderContent(t,{node:l,data:s,store:u}):a.default?()=>a.default({node:l,data:s,store:u}):void 0),filterNodeMethod:(t,l,s)=>{var u;return e.filterNodeMethod?e.filterNodeMethod(t,l,s):t?(u=n("label",l))==null?void 0:u.includes(t):!0},onNodeClick:(t,l,s)=>{var u,p,k;if((u=i.onNodeClick)==null||u.call(i,t,l,s),!(e.showCheckbox&&e.checkOnClickNode))if(!e.showCheckbox&&(e.checkStrictly||l.isLeaf)){if(!n("disabled",t)){const f=(p=r.value)==null?void 0:p.options.get(n("value",t));(k=r.value)==null||k.handleOptionSelect(f)}}else e.expandOnClickNode&&s.proxy.handleExpandIconClick()},onCheck:(t,l)=>{if(!e.showCheckbox)return;const s=n("value",t),u=l.checkedKeys,p=e.multiple?K(e.modelValue).filter(f=>f in C.value&&!o.value.getNode(f)&&!u.includes(f)):[],k=u.concat(p);if(e.checkStrictly)d(A,e.multiple?k:k.includes(s)?s:void 0);else if(e.multiple)d(A,o.value.getCheckedKeys(!0));else{const f=b([t],h=>!L(n("children",h))&&!n("disabled",h),h=>n("children",h)),N=f?n("value",f):void 0,B=T(e.modelValue)&&!!b([t],h=>n("value",h)===e.modelValue,h=>n("children",h));d(A,N===e.modelValue||B?void 0:N)}_(()=>{var f;const N=K(e.modelValue);o.value.setCheckedKeys(N),(f=i.onCheck)==null||f.call(i,t,{checkedKeys:o.value.getCheckedKeys(),checkedNodes:o.value.getCheckedNodes(),halfCheckedKeys:o.value.getHalfCheckedKeys(),halfCheckedNodes:o.value.getHalfCheckedNodes()})})},cacheOptions:y}};var Y=w({props:{data:{type:Array,default:()=>[]}},setup(e){const i=W(F);return I(()=>e.data,()=>{var a;e.data.forEach(r=>{i.cachedOptions.has(r.value)||i.cachedOptions.set(r.value,r)});const d=((a=i.selectWrapper)==null?void 0:a.querySelectorAll("input"))||[];Array.from(d).includes(document.activeElement)||i.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const Z=w({name:"ElTreeSelect",inheritAttrs:!1,props:{...M.props,...S.props,cacheData:{type:Array,default:()=>[]}},setup(e,i){const{slots:a,expose:d}=i,r=H(),o=H(),c=v(()=>e.nodeKey||e.valueKey||"value"),m=J(e,i,{select:r,tree:o,key:c}),{cacheOptions:n,...g}=X(e,i,{select:r,tree:o,key:c}),y=E({});return d(y),$(()=>{Object.assign(y,{...x(o.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...x(r.value,["focus","blur"])})}),()=>V(M,E({...m,ref:C=>r.value=C}),{...a,default:()=>[V(Y,{data:n.value}),V(S,E({...g,ref:C=>o.value=C}))]})}});var O=G(Z,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-select/src/tree-select.vue"]]);O.install=e=>{e.component(O.name,O)};const ee=O,ot=ee;export{ot as ElTreeSelect,ee as default};
