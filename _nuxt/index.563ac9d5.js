import{ElScrollbar as Ee}from"./index.8ce59d4c.js";import{Check as we,Loading as ke,ArrowRight as $e}from"./index.e0b44930.js";import{ElIcon as ye}from"./index.52232a07.js";import{f as Y,a2 as W,j as Le,a5 as be,k as N,r as $,o as y,D as _,Y as F,c as A,aK as ie,L as U,S as j,a4 as S,X as ae,I as Se,p as O,W as Ne,U as De,Q as re,x as Ve,aw as de,ad as Me,a3 as Pe,M as ce,w as J,aV as Te,H as Ie,e as He,aj as Ae}from"./entry.40f94ce2.js";import{ElCheckbox as _e}from"./index.b287272e.js";import{ElRadio as ze}from"./index.f42115ab.js";import{_ as se}from"./plugin-vue_export-helper.b0b5f2d9.js";import{u as Be}from"./index.b1f4efad.js";import{g as Fe}from"./rand.0e47716b.js";import{f as ne,a as Oe}from"./types.0ffe2429.js";import{c as ue}from"./strings.c93dd47f.js";import{i as R}from"./isEqual.f785ded9.js";import{b as qe,d as Q}from"./runtime.a8d5aa72.js";import{i as Ke,f as ee,g as Ue}from"./aria.46c29a86.js";import{U as he,C as pe}from"./event.e54e7e4a.js";import{u as fe,c as me}from"./arrays.952da6c6.js";import{s as je}from"./scroll.123f6305.js";import{E as K}from"./aria.362daa0e.js";import{b as Ze}from"./_baseFlatten.02332558.js";import{c as Re}from"./cloneDeep.0f109ce3.js";import"./index.5dbd068b.js";import"./util.c8753e63.js";import"./error.6c36bb34.js";import"./style.a7bf22e4.js";import"./install.db378abc.js";import"./index.f72caa6f.js";import"./size.007424cf.js";import"./use-form-common-props.c0d2009e.js";import"./constants.e2ce9b61.js";import"./use-form-item.eeb4683c.js";import"./pick.b27c0e8e.js";import"./_baseGet.57648035.js";import"./isArray.3fa80ba1.js";import"./isObject.5a18b265.js";import"./_baseSet.39436bc7.js";import"./_defineProperty.f71786e5.js";import"./_isIndex.f5af1eca.js";import"./_arrayPush.6d7e61e4.js";import"./flatten.a5c62c9e.js";import"./_overRest.e23153e9.js";import"./get.070bcf83.js";import"./_Uint8Array.4a2b558d.js";import"./_baseClone.00ccee08.js";import"./_initCloneObject.90ccc272.js";var xe=1/0;function Xe(e){var n=e==null?0:e.length;return n?Ze(e,xe):[]}var Ye=Y({name:"NodeContent",setup(){return{ns:W("cascader-node")}},render(){const{ns:e}=this,{node:n,panel:t}=this.$parent,{data:a,label:s}=n,{renderLabelFn:i}=t;return Le("span",{class:e.e("label")},i?i({node:n,data:a}):s)}});const oe=Symbol(),We=Y({name:"ElCascaderNode",components:{ElCheckbox:_e,ElRadio:ze,NodeContent:Ye,ElIcon:ye,Check:we,Loading:ke,ArrowRight:$e},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(e,{emit:n}){const t=be(oe),a=W("cascader-node"),s=N(()=>t.isHoverMenu),i=N(()=>t.config.multiple),l=N(()=>t.config.checkStrictly),d=N(()=>{var p;return(p=t.checkedNodes[0])==null?void 0:p.uid}),u=N(()=>e.node.isDisabled),h=N(()=>e.node.isLeaf),f=N(()=>l.value&&!h.value||!u.value),k=N(()=>E(t.expandingNode)),C=N(()=>l.value&&t.checkedNodes.some(E)),E=p=>{var w;const{level:H,uid:G}=e.node;return((w=p==null?void 0:p.pathNodes[H-1])==null?void 0:w.uid)===G},D=()=>{k.value||t.expandNode(e.node)},z=p=>{const{node:w}=e;p!==w.checked&&t.handleCheckChange(w,p)},L=()=>{t.lazyLoad(e.node,()=>{h.value||D()})},T=p=>{!s.value||(I(),!h.value&&n("expand",p))},I=()=>{const{node:p}=e;!f.value||p.loading||(p.loaded?D():L())},B=()=>{s.value&&!h.value||(h.value&&!u.value&&!l.value&&!i.value?V(!0):I())},q=p=>{l.value?(z(p),e.node.loaded&&D()):V(p)},V=p=>{e.node.loaded?(z(p),!l.value&&D()):L()};return{panel:t,isHoverMenu:s,multiple:i,checkStrictly:l,checkedNodeId:d,isDisabled:u,isLeaf:h,expandable:f,inExpandingPath:k,inCheckedPath:C,ns:a,handleHoverExpand:T,handleExpand:I,handleClick:B,handleCheck:V,handleSelectCheck:q}}}),Ge=["id","aria-haspopup","aria-owns","aria-expanded","tabindex"],Je=Se("span",null,null,-1);function Qe(e,n,t,a,s,i){const l=$("el-checkbox"),d=$("el-radio"),u=$("check"),h=$("el-icon"),f=$("node-content"),k=$("loading"),C=$("arrow-right");return y(),_("li",{id:`${e.menuId}-${e.node.uid}`,role:"menuitem","aria-haspopup":!e.isLeaf,"aria-owns":e.isLeaf?null:e.menuId,"aria-expanded":e.inExpandingPath,tabindex:e.expandable?-1:void 0,class:S([e.ns.b(),e.ns.is("selectable",e.checkStrictly),e.ns.is("active",e.node.checked),e.ns.is("disabled",!e.expandable),e.inExpandingPath&&"in-active-path",e.inCheckedPath&&"in-checked-path"]),onMouseenter:n[2]||(n[2]=(...E)=>e.handleHoverExpand&&e.handleHoverExpand(...E)),onFocus:n[3]||(n[3]=(...E)=>e.handleHoverExpand&&e.handleHoverExpand(...E)),onClick:n[4]||(n[4]=(...E)=>e.handleClick&&e.handleClick(...E))},[F(" prefix "),e.multiple?(y(),A(l,{key:0,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:e.isDisabled,onClick:n[0]||(n[0]=ie(()=>{},["stop"])),"onUpdate:modelValue":e.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onUpdate:modelValue"])):e.checkStrictly?(y(),A(d,{key:1,"model-value":e.checkedNodeId,label:e.node.uid,disabled:e.isDisabled,"onUpdate:modelValue":e.handleSelectCheck,onClick:n[1]||(n[1]=ie(()=>{},["stop"]))},{default:U(()=>[F(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),Je]),_:1},8,["model-value","label","disabled","onUpdate:modelValue"])):e.isLeaf&&e.node.checked?(y(),A(h,{key:2,class:S(e.ns.e("prefix"))},{default:U(()=>[j(u)]),_:1},8,["class"])):F("v-if",!0),F(" content "),j(f),F(" postfix "),e.isLeaf?F("v-if",!0):(y(),_(ae,{key:3},[e.node.loading?(y(),A(h,{key:0,class:S([e.ns.is("loading"),e.ns.e("postfix")])},{default:U(()=>[j(k)]),_:1},8,["class"])):(y(),A(h,{key:1,class:S(["arrow-right",e.ns.e("postfix")])},{default:U(()=>[j(C)]),_:1},8,["class"]))],64))],42,Ge)}var en=se(We,[["render",Qe],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/node.vue"]]);const nn=Y({name:"ElCascaderMenu",components:{Loading:ke,ElIcon:ye,ElScrollbar:Ee,ElCascaderNode:en},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(e){const n=Ve(),t=W("cascader-menu"),{t:a}=Be(),s=Fe();let i=null,l=null;const d=be(oe),u=O(null),h=N(()=>!e.nodes.length),f=N(()=>!d.initialLoaded),k=N(()=>`cascader-menu-${s}-${e.index}`),C=L=>{i=L.target},E=L=>{if(!(!d.isHoverMenu||!i||!u.value))if(i.contains(L.target)){D();const T=n.vnode.el,{left:I}=T.getBoundingClientRect(),{offsetWidth:B,offsetHeight:q}=T,V=L.clientX-I,p=i.offsetTop,w=p+i.offsetHeight;u.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${V} ${p} L${B} 0 V${p} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${V} ${w} L${B} ${q} V${w} Z" />
        `}else l||(l=window.setTimeout(z,d.config.hoverThreshold))},D=()=>{!l||(clearTimeout(l),l=null)},z=()=>{!u.value||(u.value.innerHTML="",D())};return{ns:t,panel:d,hoverZone:u,isEmpty:h,isLoading:f,menuId:k,t:a,handleExpand:C,handleMouseMove:E,clearHoverZone:z}}});function tn(e,n,t,a,s,i){const l=$("el-cascader-node"),d=$("loading"),u=$("el-icon"),h=$("el-scrollbar");return y(),A(h,{key:e.menuId,tag:"ul",role:"menu",class:S(e.ns.b()),"wrap-class":e.ns.e("wrap"),"view-class":[e.ns.e("list"),e.ns.is("empty",e.isEmpty)],onMousemove:e.handleMouseMove,onMouseleave:e.clearHoverZone},{default:U(()=>{var f;return[(y(!0),_(ae,null,Ne(e.nodes,k=>(y(),A(l,{key:k.uid,node:k,"menu-id":e.menuId,onExpand:e.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),e.isLoading?(y(),_("div",{key:0,class:S(e.ns.e("empty-text"))},[j(u,{size:"14",class:S(e.ns.is("loading"))},{default:U(()=>[j(d)]),_:1},8,["class"]),De(" "+re(e.t("el.cascader.loading")),1)],2)):e.isEmpty?(y(),_("div",{key:1,class:S(e.ns.e("empty-text"))},re(e.t("el.cascader.noData")),3)):(f=e.panel)!=null&&f.isHoverMenu?(y(),_("svg",{key:2,ref:"hoverZone",class:S(e.ns.e("hover-zone"))},null,2)):F("v-if",!0)]}),_:1},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var an=se(nn,[["render",tn],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/menu.vue"]]);let sn=0;const on=e=>{const n=[e];let{parent:t}=e;for(;t;)n.unshift(t),t=t.parent;return n};class Z{constructor(n,t,a,s=!1){this.data=n,this.config=t,this.parent=a,this.root=s,this.uid=sn++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:i,label:l,children:d}=t,u=n[d],h=on(this);this.level=s?0:a?a.level+1:1,this.value=n[i],this.label=n[l],this.pathNodes=h,this.pathValues=h.map(f=>f.value),this.pathLabels=h.map(f=>f.label),this.childrenData=u,this.children=(u||[]).map(f=>new Z(f,t,this)),this.loaded=!t.lazy||this.isLeaf||!ne(u)}get isDisabled(){const{data:n,parent:t,config:a}=this,{disabled:s,checkStrictly:i}=a;return(de(s)?s(n,this):!!n[s])||!i&&(t==null?void 0:t.isDisabled)}get isLeaf(){const{data:n,config:t,childrenData:a,loaded:s}=this,{lazy:i,leaf:l}=t,d=de(l)?l(n,this):n[l];return Oe(d)?i&&!s?!1:!(Array.isArray(a)&&a.length):!!d}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(n){const{childrenData:t,children:a}=this,s=new Z(n,this.config,this);return Array.isArray(t)?t.push(n):this.childrenData=[n],a.push(s),s}calcText(n,t){const a=n?this.pathLabels.join(t):this.label;return this.text=a,a}broadcast(n,...t){const a=`onParent${ue(n)}`;this.children.forEach(s=>{s&&(s.broadcast(n,...t),s[a]&&s[a](...t))})}emit(n,...t){const{parent:a}=this,s=`onChild${ue(n)}`;a&&(a[s]&&a[s](...t),a.emit(n,...t))}onParentCheck(n){this.isDisabled||this.setCheckState(n)}onChildCheck(){const{children:n}=this,t=n.filter(s=>!s.isDisabled),a=t.length?t.every(s=>s.checked):!1;this.setCheckState(a)}setCheckState(n){const t=this.children.length,a=this.children.reduce((s,i)=>{const l=i.checked?1:i.indeterminate?.5:0;return s+l},0);this.checked=this.loaded&&this.children.filter(s=>!s.isDisabled).every(s=>s.loaded&&s.checked)&&n,this.indeterminate=this.loaded&&a!==t&&a>0}doCheck(n){if(this.checked===n)return;const{checkStrictly:t,multiple:a}=this.config;t||!a?this.checked=n:(this.broadcast("check",n),this.setCheckState(n),this.emit("check"))}}const te=(e,n)=>e.reduce((t,a)=>(a.isLeaf?t.push(a):(!n&&t.push(a),t=t.concat(te(a.children,n))),t),[]);class ve{constructor(n,t){this.config=t;const a=(n||[]).map(s=>new Z(s,this.config));this.nodes=a,this.allNodes=te(a,!1),this.leafNodes=te(a,!0)}getNodes(){return this.nodes}getFlattedNodes(n){return n?this.leafNodes:this.allNodes}appendNode(n,t){const a=t?t.appendChild(n):new Z(n,this.config);t||this.nodes.push(a),this.allNodes.push(a),a.isLeaf&&this.leafNodes.push(a)}appendNodes(n,t){n.forEach(a=>this.appendNode(a,t))}getNodeByValue(n,t=!1){return!n&&n!==0?null:this.getFlattedNodes(t).find(s=>R(s.value,n)||R(s.pathValues,n))||null}getSameNode(n){return n&&this.getFlattedNodes(!1).find(({value:a,level:s})=>R(n.value,a)&&n.level===s)||null}}const ln=qe({modelValue:{type:Q([Number,String,Array])},options:{type:Q(Array),default:()=>[]},props:{type:Q(Object),default:()=>({})}}),rn={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:Me,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},dn=e=>N(()=>({...rn,...e.props})),ge=e=>{if(!e)return 0;const n=e.id.split("-");return Number(n[n.length-2])},cn=e=>{if(!e)return;const n=e.querySelector("input");n?n.click():Ke(e)&&e.click()},un=(e,n)=>{const t=n.slice(0),a=t.map(i=>i.uid),s=e.reduce((i,l)=>{const d=a.indexOf(l.uid);return d>-1&&(i.push(l),t.splice(d,1),a.splice(d,1)),i},[]);return s.push(...t),s},hn=Y({name:"ElCascaderPanel",components:{ElCascaderMenu:an},props:{...ln,border:{type:Boolean,default:!0},renderLabel:Function},emits:[he,pe,"close","expand-change"],setup(e,{emit:n,slots:t}){let a=!1;const s=W("cascader"),i=dn(e);let l=null;const d=O(!0),u=O([]),h=O(null),f=O([]),k=O(null),C=O([]),E=N(()=>i.value.expandTrigger==="hover"),D=N(()=>e.renderLabel||t.default),z=()=>{const{options:o}=e,r=i.value;a=!1,l=new ve(o,r),f.value=[l.getNodes()],r.lazy&&ne(e.options)?(d.value=!1,L(void 0,c=>{c&&(l=new ve(c,r),f.value=[l.getNodes()]),d.value=!0,H(!1,!0)})):H(!1,!0)},L=(o,r)=>{const c=i.value;o=o||new Z({},c,void 0,!0),o.loading=!0;const m=v=>{const g=o,M=g.root?null:g;v&&(l==null||l.appendNodes(v,M)),g.loading=!1,g.loaded=!0,g.childrenData=g.childrenData||[],r&&r(v)};c.lazyLoad(o,m)},T=(o,r)=>{var c;const{level:m}=o,v=f.value.slice(0,m);let g;o.isLeaf?g=o.pathNodes[m-2]:(g=o,v.push(o.children)),((c=k.value)==null?void 0:c.uid)!==(g==null?void 0:g.uid)&&(k.value=o,f.value=v,!r&&n("expand-change",(o==null?void 0:o.pathValues)||[]))},I=(o,r,c=!0)=>{const{checkStrictly:m,multiple:v}=i.value,g=C.value[0];a=!0,!v&&(g==null||g.doCheck(!1)),o.doCheck(r),w(),c&&!v&&!m&&n("close"),!c&&!v&&!m&&B(o)},B=o=>{!o||(o=o.parent,B(o),o&&T(o))},q=o=>l==null?void 0:l.getFlattedNodes(o),V=o=>{var r;return(r=q(o))==null?void 0:r.filter(c=>c.checked!==!1)},p=()=>{C.value.forEach(o=>o.doCheck(!1)),w(),f.value=f.value.slice(0,1),k.value=null,n("expand-change",[])},w=()=>{var o;const{checkStrictly:r,multiple:c}=i.value,m=C.value,v=V(!r),g=un(m,v),M=g.map(b=>b.valueByOption);C.value=g,h.value=c?M:(o=M[0])!=null?o:null},H=(o=!1,r=!1)=>{const{modelValue:c}=e,{lazy:m,multiple:v,checkStrictly:g}=i.value,M=!g;if(!(!d.value||a||!r&&R(c,h.value)))if(m&&!o){const x=fe(Xe(me(c))).map(P=>l==null?void 0:l.getNodeByValue(P)).filter(P=>!!P&&!P.loaded&&!P.loading);x.length?x.forEach(P=>{L(P,()=>H(!1,r))}):H(!0,r)}else{const b=v?me(c):[c],x=fe(b.map(P=>l==null?void 0:l.getNodeByValue(P,M)));G(x,r),h.value=Re(c)}},G=(o,r=!0)=>{const{checkStrictly:c}=i.value,m=C.value,v=o.filter(b=>!!b&&(c||b.isLeaf)),g=l==null?void 0:l.getSameNode(k.value),M=r&&g||v[0];M?M.pathNodes.forEach(b=>T(b,!0)):k.value=null,m.forEach(b=>b.doCheck(!1)),e.props.multiple?ce(v).forEach(b=>b.doCheck(!0)):v.forEach(b=>b.doCheck(!0)),C.value=v,He(le)},le=()=>{!Ae||u.value.forEach(o=>{const r=o==null?void 0:o.$el;if(r){const c=r.querySelector(`.${s.namespace.value}-scrollbar__wrap`),m=r.querySelector(`.${s.b("node")}.${s.is("active")}`)||r.querySelector(`.${s.b("node")}.in-active-path`);je(c,m)}})},Ce=o=>{const r=o.target,{code:c}=o;switch(c){case K.up:case K.down:{o.preventDefault();const m=c===K.up?-1:1;ee(Ue(r,m,`.${s.b("node")}[tabindex="-1"]`));break}case K.left:{o.preventDefault();const m=u.value[ge(r)-1],v=m==null?void 0:m.$el.querySelector(`.${s.b("node")}[aria-expanded="true"]`);ee(v);break}case K.right:{o.preventDefault();const m=u.value[ge(r)+1],v=m==null?void 0:m.$el.querySelector(`.${s.b("node")}[tabindex="-1"]`);ee(v);break}case K.enter:cn(r);break}};return Pe(oe,ce({config:i,expandingNode:k,checkedNodes:C,isHoverMenu:E,initialLoaded:d,renderLabelFn:D,lazyLoad:L,expandNode:T,handleCheckChange:I})),J([i,()=>e.options],z,{deep:!0,immediate:!0}),J(()=>e.modelValue,()=>{a=!1,H()},{deep:!0}),J(()=>h.value,o=>{R(o,e.modelValue)||(n(he,o),n(pe,o))}),Te(()=>u.value=[]),Ie(()=>!ne(e.modelValue)&&H()),{ns:s,menuList:u,menus:f,checkedNodes:C,handleKeyDown:Ce,handleCheckChange:I,getFlattedNodes:q,getCheckedNodes:V,clearCheckedNodes:p,calculateCheckedValue:w,scrollToExpandingNode:le}}});function pn(e,n,t,a,s,i){const l=$("el-cascader-menu");return y(),_("div",{class:S([e.ns.b("panel"),e.ns.is("bordered",e.border)]),onKeydown:n[0]||(n[0]=(...d)=>e.handleKeyDown&&e.handleKeyDown(...d))},[(y(!0),_(ae,null,Ne(e.menus,(d,u)=>(y(),A(l,{key:u,ref_for:!0,ref:h=>e.menuList[u]=h,index:u,nodes:[...d]},null,8,["index","nodes"]))),128))],34)}var X=se(hn,[["render",pn],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/index.vue"]]);X.install=e=>{e.component(X.name,X)};const fn=X,ot=fn;export{oe as CASCADER_PANEL_INJECTION_KEY,ln as CommonProps,rn as DefaultProps,ot as ElCascaderPanel,fn as default,dn as useCascaderConfig};
