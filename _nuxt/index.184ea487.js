import{f as j,aN as P,a2 as ce,p as x,aO as fe,aE as me,k as g,w as Z,e as de,H as pe,o as C,c as H,S as n,L as p,I as f,a4 as c,u as t,R as K,aK as ve,Y as z,D as R,X as W,P as ge,W as we,Z as be,$ as ke,K as _e,a7 as Ie,az as he}from"./entry.40f94ce2.js";import{b as y}from"./index.5dbd068b.js";import{ElIcon as w}from"./index.52232a07.js";import{FullScreen as xe,ScaleToOriginal as Ce,Close as ze,ArrowLeft as Ne,ArrowRight as ye,ZoomOut as Oe,ZoomIn as Le,RefreshLeft as Ee,RefreshRight as Te}from"./index.e0b44930.js";import{b as Re,d as Ae}from"./runtime.a8d5aa72.js";import{m as Se}from"./typescript.c44ade1c.js";import{c as G}from"./types.0ffe2429.js";import{_ as $e}from"./plugin-vue_export-helper.b0b5f2d9.js";import{u as Ve}from"./index.b1f4efad.js";import{u as Xe}from"./index.1eb5ee59.js";import{E as I}from"./aria.362daa0e.js";import{k as Ye}from"./objects.1e9cc2c5.js";import{t as A}from"./throttle.d970eabc.js";import{w as Me}from"./install.db378abc.js";import"./style.a7bf22e4.js";import"./get.070bcf83.js";import"./_baseGet.57648035.js";import"./isArray.3fa80ba1.js";import"./isObject.5a18b265.js";import"./_baseSet.39436bc7.js";import"./_defineProperty.f71786e5.js";import"./_isIndex.f5af1eca.js";import"./debounce.a43f57fe.js";const Be=Re({urlList:{type:Ae(Array),default:()=>Se([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),De={close:()=>!0,switch:O=>G(O)},Fe=["src"],Pe=j({name:"ElImageViewer"}),Ze=j({...Pe,props:Be,emits:De,setup(O,{expose:q,emit:S}){const l=O,h={CONTAIN:{name:"contain",icon:P(xe)},ORIGINAL:{name:"original",icon:P(Ce)}},{t:J}=Ve(),o=ce("image-viewer"),{nextZIndex:Q}=Xe(),L=x(),$=x([]),V=fe(),k=x(!0),v=x(l.initialIndex),N=me(h.CONTAIN),r=x({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),U=g(()=>{const{urlList:e}=l;return e.length<=1}),X=g(()=>v.value===0),Y=g(()=>v.value===l.urlList.length-1),ee=g(()=>l.urlList[v.value]),te=g(()=>[o.e("btn"),o.e("prev"),o.is("disabled",!l.infinite&&X.value)]),ae=g(()=>[o.e("btn"),o.e("next"),o.is("disabled",!l.infinite&&Y.value)]),se=g(()=>{const{scale:e,deg:a,offsetX:s,offsetY:i,enableTransition:m}=r.value;let u=s/e,d=i/e;switch(a%360){case 90:case-270:[u,d]=[d,-u];break;case 180:case-180:[u,d]=[-u,-d];break;case 270:case-90:[u,d]=[-d,u];break}const _={transform:`scale(${e}) rotate(${a}deg) translate(${u}px, ${d}px)`,transition:m?"transform .3s":""};return N.value.name===h.CONTAIN.name&&(_.maxWidth=_.maxHeight="100%"),_}),oe=g(()=>G(l.zIndex)?l.zIndex:Q());function E(){re(),S("close")}function ne(){const e=A(s=>{switch(s.code){case I.esc:l.closeOnPressEscape&&E();break;case I.space:B();break;case I.left:D();break;case I.up:b("zoomIn");break;case I.right:F();break;case I.down:b("zoomOut");break}}),a=A(s=>{const i=s.deltaY||s.deltaX;b(i<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})});V.run(()=>{y(document,"keydown",e),y(document,"wheel",a)})}function re(){V.stop()}function le(){k.value=!1}function ie(e){k.value=!1,e.target.alt=J("el.image.error")}function ue(e){if(k.value||e.button!==0||!L.value)return;r.value.enableTransition=!1;const{offsetX:a,offsetY:s}=r.value,i=e.pageX,m=e.pageY,u=A(_=>{r.value={...r.value,offsetX:a+_.pageX-i,offsetY:s+_.pageY-m}}),d=y(document,"mousemove",u);y(document,"mouseup",()=>{d()}),e.preventDefault()}function M(){r.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function B(){if(k.value)return;const e=Ye(h),a=Object.values(h),s=N.value.name,m=(a.findIndex(u=>u.name===s)+1)%e.length;N.value=h[e[m]],M()}function T(e){const a=l.urlList.length;v.value=(e+a)%a}function D(){X.value&&!l.infinite||T(v.value-1)}function F(){Y.value&&!l.infinite||T(v.value+1)}function b(e,a={}){if(k.value)return;const{zoomRate:s,rotateDeg:i,enableTransition:m}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...a};switch(e){case"zoomOut":r.value.scale>.2&&(r.value.scale=Number.parseFloat((r.value.scale/s).toFixed(3)));break;case"zoomIn":r.value.scale<7&&(r.value.scale=Number.parseFloat((r.value.scale*s).toFixed(3)));break;case"clockwise":r.value.deg+=i;break;case"anticlockwise":r.value.deg-=i;break}r.value.enableTransition=m}return Z(ee,()=>{de(()=>{const e=$.value[0];e!=null&&e.complete||(k.value=!0)})}),Z(v,e=>{M(),S("switch",e)}),pe(()=>{var e,a;ne(),(a=(e=L.value)==null?void 0:e.focus)==null||a.call(e)}),q({setActiveItem:T}),(e,a)=>(C(),H(he,{to:"body",disabled:!e.teleported},[n(Ie,{name:"viewer-fade",appear:""},{default:p(()=>[f("div",{ref_key:"wrapper",ref:L,tabindex:-1,class:c(t(o).e("wrapper")),style:K({zIndex:t(oe)})},[f("div",{class:c(t(o).e("mask")),onClick:a[0]||(a[0]=ve(s=>e.hideOnClickModal&&E(),["self"]))},null,2),z(" CLOSE "),f("span",{class:c([t(o).e("btn"),t(o).e("close")]),onClick:E},[n(t(w),null,{default:p(()=>[n(t(ze))]),_:1})],2),z(" ARROW "),t(U)?z("v-if",!0):(C(),R(W,{key:0},[f("span",{class:c(t(te)),onClick:D},[n(t(w),null,{default:p(()=>[n(t(Ne))]),_:1})],2),f("span",{class:c(t(ae)),onClick:F},[n(t(w),null,{default:p(()=>[n(t(ye))]),_:1})],2)],64)),z(" ACTIONS "),f("div",{class:c([t(o).e("btn"),t(o).e("actions")])},[f("div",{class:c(t(o).e("actions__inner"))},[n(t(w),{onClick:a[1]||(a[1]=s=>b("zoomOut"))},{default:p(()=>[n(t(Oe))]),_:1}),n(t(w),{onClick:a[2]||(a[2]=s=>b("zoomIn"))},{default:p(()=>[n(t(Le))]),_:1}),f("i",{class:c(t(o).e("actions__divider"))},null,2),n(t(w),{onClick:B},{default:p(()=>[(C(),H(ge(t(N).icon)))]),_:1}),f("i",{class:c(t(o).e("actions__divider"))},null,2),n(t(w),{onClick:a[3]||(a[3]=s=>b("anticlockwise"))},{default:p(()=>[n(t(Ee))]),_:1}),n(t(w),{onClick:a[4]||(a[4]=s=>b("clockwise"))},{default:p(()=>[n(t(Te))]),_:1})],2)],2),z(" CANVAS "),f("div",{class:c(t(o).e("canvas"))},[(C(!0),R(W,null,we(e.urlList,(s,i)=>be((C(),R("img",{ref_for:!0,ref:m=>$.value[i]=m,key:s,src:s,style:K(t(se)),class:c(t(o).e("img")),onLoad:le,onError:ie,onMousedown:ue},null,46,Fe)),[[ke,i===v.value]])),128))],2),_e(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var He=$e(Ze,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const vt=Me(He);export{vt as ElImageViewer,vt as default,De as imageViewerEmits,Be as imageViewerProps};
