import{i as W,K as F,f as ce,b as x,aP as me,aH as fe,h as g,e as Z,Z as de,S as pe,o as C,c as H,v as n,w as p,m,k as c,u as t,Q as K,z as ve,P as z,j as R,L as j,O as ge,M as be,x as we,y as ke,r as _e,T as Ie,aE as he}from"./entry.b33cb278.js";import{b as N}from"./index.785ddeeb.js";import{ElIcon as b}from"./index.960dedfd.js";import{Close as xe,ArrowLeft as Ce,ArrowRight as ze,ZoomOut as ye,ZoomIn as Ne,RefreshLeft as Oe,RefreshRight as Le,FullScreen as Ee,ScaleToOriginal as Te}from"./index.dc3cf8fc.js";import{b as Re,d as Ae}from"./runtime.ca6a5e5a.js";import{m as Se}from"./typescript.c44ade1c.js";import{i as G}from"./types.bb628c62.js";import{_ as Ve}from"./plugin-vue_export-helper.b0b5f2d9.js";import{u as $e}from"./index.fd65d236.js";import{u as Me}from"./index.8e2f8365.js";import{E as I}from"./aria.362daa0e.js";import{k as Xe}from"./objects.1e9cc2c5.js";import{t as A}from"./throttle.d970eabc.js";import{w as Ye}from"./install.187cf5b6.js";import"./style.6fe07f58.js";import"./get.070bcf83.js";import"./_baseGet.57648035.js";import"./isArray.3fa80ba1.js";import"./isObject.5a18b265.js";import"./_baseSet.39436bc7.js";import"./_defineProperty.f71786e5.js";import"./_isIndex.f5af1eca.js";import"./debounce.a43f57fe.js";const Be=Re({urlList:{type:Ae(Array),default:()=>Se([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),Pe={close:()=>!0,switch:O=>G(O)},De=["src"],Fe=W({name:"ElImageViewer"}),Ze=W({...Fe,props:Be,emits:Pe,setup(O,{expose:Q,emit:S}){const l=O,h={CONTAIN:{name:"contain",icon:F(Ee)},ORIGINAL:{name:"original",icon:F(Te)}},{t:q}=$e(),o=ce("image-viewer"),{nextZIndex:J}=Me(),L=x(),V=x([]),$=me(),k=x(!0),v=x(l.initialIndex),y=fe(h.CONTAIN),r=x({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),U=g(()=>{const{urlList:e}=l;return e.length<=1}),M=g(()=>v.value===0),X=g(()=>v.value===l.urlList.length-1),ee=g(()=>l.urlList[v.value]),te=g(()=>[o.e("btn"),o.e("prev"),o.is("disabled",!l.infinite&&M.value)]),ae=g(()=>[o.e("btn"),o.e("next"),o.is("disabled",!l.infinite&&X.value)]),se=g(()=>{const{scale:e,deg:a,offsetX:s,offsetY:i,enableTransition:f}=r.value;let u=s/e,d=i/e;switch(a%360){case 90:case-270:[u,d]=[d,-u];break;case 180:case-180:[u,d]=[-u,-d];break;case 270:case-90:[u,d]=[-d,u];break}const _={transform:`scale(${e}) rotate(${a}deg) translate(${u}px, ${d}px)`,transition:f?"transform .3s":""};return y.value.name===h.CONTAIN.name&&(_.maxWidth=_.maxHeight="100%"),_}),oe=g(()=>G(l.zIndex)?l.zIndex:J());function E(){re(),S("close")}function ne(){const e=A(s=>{switch(s.code){case I.esc:l.closeOnPressEscape&&E();break;case I.space:B();break;case I.left:P();break;case I.up:w("zoomIn");break;case I.right:D();break;case I.down:w("zoomOut");break}}),a=A(s=>{const i=s.deltaY||s.deltaX;w(i<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})});$.run(()=>{N(document,"keydown",e),N(document,"wheel",a)})}function re(){$.stop()}function le(){k.value=!1}function ie(e){k.value=!1,e.target.alt=q("el.image.error")}function ue(e){if(k.value||e.button!==0||!L.value)return;r.value.enableTransition=!1;const{offsetX:a,offsetY:s}=r.value,i=e.pageX,f=e.pageY,u=A(_=>{r.value={...r.value,offsetX:a+_.pageX-i,offsetY:s+_.pageY-f}}),d=N(document,"mousemove",u);N(document,"mouseup",()=>{d()}),e.preventDefault()}function Y(){r.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function B(){if(k.value)return;const e=Xe(h),a=Object.values(h),s=y.value.name,f=(a.findIndex(u=>u.name===s)+1)%e.length;y.value=h[e[f]],Y()}function T(e){const a=l.urlList.length;v.value=(e+a)%a}function P(){M.value&&!l.infinite||T(v.value-1)}function D(){X.value&&!l.infinite||T(v.value+1)}function w(e,a={}){if(k.value)return;const{zoomRate:s,rotateDeg:i,enableTransition:f}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...a};switch(e){case"zoomOut":r.value.scale>.2&&(r.value.scale=Number.parseFloat((r.value.scale/s).toFixed(3)));break;case"zoomIn":r.value.scale<7&&(r.value.scale=Number.parseFloat((r.value.scale*s).toFixed(3)));break;case"clockwise":r.value.deg+=i;break;case"anticlockwise":r.value.deg-=i;break}r.value.enableTransition=f}return Z(ee,()=>{de(()=>{const e=V.value[0];e!=null&&e.complete||(k.value=!0)})}),Z(v,e=>{Y(),S("switch",e)}),pe(()=>{var e,a;ne(),(a=(e=L.value)==null?void 0:e.focus)==null||a.call(e)}),Q({setActiveItem:T}),(e,a)=>(C(),H(he,{to:"body",disabled:!e.teleported},[n(Ie,{name:"viewer-fade",appear:""},{default:p(()=>[m("div",{ref_key:"wrapper",ref:L,tabindex:-1,class:c(t(o).e("wrapper")),style:K({zIndex:t(oe)})},[m("div",{class:c(t(o).e("mask")),onClick:a[0]||(a[0]=ve(s=>e.hideOnClickModal&&E(),["self"]))},null,2),z(" CLOSE "),m("span",{class:c([t(o).e("btn"),t(o).e("close")]),onClick:E},[n(t(b),null,{default:p(()=>[n(t(xe))]),_:1})],2),z(" ARROW "),t(U)?z("v-if",!0):(C(),R(j,{key:0},[m("span",{class:c(t(te)),onClick:P},[n(t(b),null,{default:p(()=>[n(t(Ce))]),_:1})],2),m("span",{class:c(t(ae)),onClick:D},[n(t(b),null,{default:p(()=>[n(t(ze))]),_:1})],2)],64)),z(" ACTIONS "),m("div",{class:c([t(o).e("btn"),t(o).e("actions")])},[m("div",{class:c(t(o).e("actions__inner"))},[n(t(b),{onClick:a[1]||(a[1]=s=>w("zoomOut"))},{default:p(()=>[n(t(ye))]),_:1}),n(t(b),{onClick:a[2]||(a[2]=s=>w("zoomIn"))},{default:p(()=>[n(t(Ne))]),_:1}),m("i",{class:c(t(o).e("actions__divider"))},null,2),n(t(b),{onClick:B},{default:p(()=>[(C(),H(ge(t(y).icon)))]),_:1}),m("i",{class:c(t(o).e("actions__divider"))},null,2),n(t(b),{onClick:a[3]||(a[3]=s=>w("anticlockwise"))},{default:p(()=>[n(t(Oe))]),_:1}),n(t(b),{onClick:a[4]||(a[4]=s=>w("clockwise"))},{default:p(()=>[n(t(Le))]),_:1})],2)],2),z(" CANVAS "),m("div",{class:c(t(o).e("canvas"))},[(C(!0),R(j,null,be(e.urlList,(s,i)=>we((C(),R("img",{ref_for:!0,ref:f=>V.value[i]=f,key:s,src:s,style:K(t(se)),class:c(t(o).e("img")),onLoad:le,onError:ie,onMousedown:ue},null,46,De)),[[ke,i===v.value]])),128))],2),_e(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var He=Ve(Ze,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const vt=Ye(He);export{vt as ElImageViewer,vt as default,Pe as imageViewerEmits,Be as imageViewerProps};
