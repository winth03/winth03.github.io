import{ElSelect as S,ElOption as w,selectKey as F}from"./index.e97bce3e.js";import M from"./index.9c23bb2c.js";import{f as R,a2 as H,h as v,Z as _,i as L,R as U,e as B,aB as z,l as W,b as P,ah as V,S as Z,a1 as x}from"./entry.b33cb278.js";import{p as E}from"./pick.b27c0e8e.js";import{U as A}from"./event.e54e7e4a.js";import{i as $}from"./isEqual.f785ded9.js";import{_ as D}from"./plugin-vue_export-helper.b0b5f2d9.js";import"./index.785ddeeb.js";import"./index.71f51d66.js";import"./runtime.ca6a5e5a.js";import"./types.bb628c62.js";import"./index.8e2f8365.js";import"./constants.e2ce9b61.js";import"./focus-trap.90d54f15.js";import"./aria.362daa0e.js";import"./install.187cf5b6.js";import"./index.3fb8a01c.js";import"./index.960dedfd.js";import"./style.6fe07f58.js";import"./index.dc3cf8fc.js";import"./browser.c687ae44.js";import"./index.3ddc1a68.js";import"./size.007424cf.js";import"./icon.13fbe947.js";import"./typescript.c44ade1c.js";import"./index.0bdbd461.js";import"./use-form-item.ec62bf83.js";import"./use-form-common-props.a25456a0.js";import"./error.6c36bb34.js";import"./i18n.de31208d.js";import"./index.eec93737.js";import"./event.079378dc.js";import"./index.0fbbdc81.js";import"./util.c8753e63.js";import"./index.34335150.js";import"./strings.14c3ebe5.js";import"./get.070bcf83.js";import"./_baseGet.57648035.js";import"./isArray.3fa80ba1.js";import"./isObject.5a18b265.js";import"./index.fd65d236.js";import"./index.7867a6df.js";import"./scroll.edc775c4.js";import"./debounce.a43f57fe.js";import"./index.e6e00c11.js";import"./validator.f60c176b.js";import"./_Uint8Array.4a2b558d.js";import"./_arrayPush.6d7e61e4.js";import"./_isIndex.f5af1eca.js";import"./index.5cdb2cce.js";import"./index.2ba28698.js";import"./_baseSet.39436bc7.js";import"./_defineProperty.f71786e5.js";import"./flatten.a5c62c9e.js";import"./_baseFlatten.02332558.js";import"./_overRest.e23153e9.js";const G=(e,{attrs:i},{tree:a,key:d})=>{const r=R("tree-select"),o={...E(H(e),Object.keys(S.props)),...i,valueKey:d,popperClass:v(()=>{const c=[r.e("popper")];return e.popperClass&&c.push(e.popperClass),c.join(" ")}),filterMethod:(c="")=>{e.filterMethod&&e.filterMethod(c),_(()=>{var m;(m=a.value)==null||m.filter(c)})},onVisibleChange:c=>{var m;(m=i.onVisibleChange)==null||m.call(i,c),e.filterable&&c&&o.filterMethod()}};return o},J=L({extends:w,setup(e,i){const a=w.setup(e,i);delete a.selectOptionClick;const d=U().proxy;return _(()=>{a.select.cachedOptions.get(d.value)||a.select.onOptionCreate(d)}),a},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function T(e){return e||e===0}function j(e){return Array.isArray(e)&&e.length}function K(e){return Array.isArray(e)?e:T(e)?[e]:[]}function b(e,i,a,d,r){for(let o=0;o<e.length;o++){const c=e[o];if(i(c,o,e,r))return d?d(c,o,e,r):c;{const m=a(c);if(j(m)){const n=b(m,i,a,d,c);if(n)return n}}}}function I(e,i,a,d){for(let r=0;r<e.length;r++){const o=e[r];i(o,r,e,d);const c=a(o);j(c)&&I(c,i,a,o)}}const Q=(e,{attrs:i,slots:a,emit:d},{select:r,tree:o,key:c})=>{B(()=>e.modelValue,()=>{e.showCheckbox&&_(()=>{const t=o.value;t&&!$(t.getCheckedKeys(),K(e.modelValue))&&t.setCheckedKeys(K(e.modelValue))})},{immediate:!0,deep:!0});const m=v(()=>({value:c.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),n=(t,l)=>{var s;const u=m.value[t];return z(u)?u(l,(s=o.value)==null?void 0:s.getNode(n("value",l))):l[u]},g=K(e.modelValue).map(t=>b(e.data||[],l=>n("value",l)===t,l=>n("children",l),(l,s,u,p)=>p&&n("value",p))).filter(t=>T(t)),y=v(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const t=[];return I(e.data.concat(e.cacheData),l=>{const s=n("value",l);t.push({value:s,currentLabel:n("label",l),isDisabled:n("disabled",l)})},l=>n("children",l)),t}),C=v(()=>y.value.reduce((t,l)=>({...t,[l.value]:l}),{}));return{...E(H(e),Object.keys(M.props)),...i,nodeKey:c,expandOnClickNode:v(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:v(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(g):g),renderContent:(t,{node:l,data:s,store:u})=>t(J,{value:n("value",s),label:n("label",s),disabled:n("disabled",s)},e.renderContent?()=>e.renderContent(t,{node:l,data:s,store:u}):a.default?()=>a.default({node:l,data:s,store:u}):void 0),filterNodeMethod:(t,l,s)=>{var u;return e.filterNodeMethod?e.filterNodeMethod(t,l,s):t?(u=n("label",l))==null?void 0:u.includes(t):!0},onNodeClick:(t,l,s)=>{var u,p,k;if((u=i.onNodeClick)==null||u.call(i,t,l,s),!(e.showCheckbox&&e.checkOnClickNode))if(!e.showCheckbox&&(e.checkStrictly||l.isLeaf)){if(!n("disabled",t)){const f=(p=r.value)==null?void 0:p.options.get(n("value",t));(k=r.value)==null||k.handleOptionSelect(f)}}else e.expandOnClickNode&&s.proxy.handleExpandIconClick()},onCheck:(t,l)=>{if(!e.showCheckbox)return;const s=n("value",t),u=l.checkedKeys,p=e.multiple?K(e.modelValue).filter(f=>f in C.value&&!o.value.getNode(f)&&!u.includes(f)):[],k=u.concat(p);if(e.checkStrictly)d(A,e.multiple?k:k.includes(s)?s:void 0);else if(e.multiple)d(A,o.value.getCheckedKeys(!0));else{const f=b([t],h=>!j(n("children",h))&&!n("disabled",h),h=>n("children",h)),N=f?n("value",f):void 0,q=T(e.modelValue)&&!!b([t],h=>n("value",h)===e.modelValue,h=>n("children",h));d(A,N===e.modelValue||q?void 0:N)}_(()=>{var f;const N=K(e.modelValue);o.value.setCheckedKeys(N),(f=i.onCheck)==null||f.call(i,t,{checkedKeys:o.value.getCheckedKeys(),checkedNodes:o.value.getCheckedNodes(),halfCheckedKeys:o.value.getHalfCheckedKeys(),halfCheckedNodes:o.value.getHalfCheckedNodes()})})},cacheOptions:y}};var X=L({props:{data:{type:Array,default:()=>[]}},setup(e){const i=W(F);return B(()=>e.data,()=>{var a;e.data.forEach(r=>{i.cachedOptions.has(r.value)||i.cachedOptions.set(r.value,r)});const d=((a=i.selectWrapper)==null?void 0:a.querySelectorAll("input"))||[];Array.from(d).includes(document.activeElement)||i.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const Y=L({name:"ElTreeSelect",inheritAttrs:!1,props:{...S.props,...M.props,cacheData:{type:Array,default:()=>[]}},setup(e,i){const{slots:a,expose:d}=i,r=P(),o=P(),c=v(()=>e.nodeKey||e.valueKey||"value"),m=G(e,i,{select:r,tree:o,key:c}),{cacheOptions:n,...g}=Q(e,i,{select:r,tree:o,key:c}),y=V({});return d(y),Z(()=>{Object.assign(y,{...E(o.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...E(r.value,["focus","blur"])})}),()=>x(S,V({...m,ref:C=>r.value=C}),{...a,default:()=>[x(X,{data:n.value}),x(M,V({...g,ref:C=>o.value=C}))]})}});var O=D(Y,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-select/src/tree-select.vue"]]);O.install=e=>{e.component(O.name,O)};const ee=O,ot=ee;export{ot as ElTreeSelect,ee as default};
