import{i as Ve,aM as Xe,f as Se,b as c,h as u,aW as Ze,e as B,Z as N,S as Je,o as i,c as w,w as v,x as R,j as y,k as m,u as o,Q as Ye,v as D,z as re,L as ie,M as ue,t as F,m as z,q as et,aX as tt,P as H,aq as lt,y as _e,r as ot,I as at}from"./entry.7f953a48.js";import{u as st,g as nt}from"./index.30f9c5c6.js";import rt,{CommonProps as it}from"./index.fabce39b.js";import{ElInput as ut}from"./index.ffd54757.js";import{u as ct,E as Pe}from"./index.5c4ee287.js";import{ElScrollbar as pt}from"./index.80bafb5b.js";import{tagProps as dt,ElTag as xe}from"./index.ccfe103f.js";import{ElIcon as ce}from"./index.fbf6b4c2.js";import{CircleClose as ft,ArrowDown as vt,Check as mt}from"./index.597e0eaa.js";import{b as gt,d as Ne}from"./runtime.7bbd0ea7.js";import{u as ht}from"./index.f298a15c.js";import{U as $e,C as Ie}from"./event.e54e7e4a.js";import{d as bt}from"./types.6589216f.js";import{_ as yt}from"./plugin-vue_export-helper.b0b5f2d9.js";import{u as Ct}from"./index.80475980.js";import{a as kt}from"./use-form-item.dcfc827e.js";import{u as Tt}from"./use-form-common-props.5d54d907.js";import{d as wt}from"./error.6c36bb34.js";import{i as Et}from"./i18n.de31208d.js";import{E}from"./aria.362daa0e.js";import{f as St,g as _t}from"./aria.46c29a86.js";import{C as Pt}from"./index.55cf4f11.js";import{c as xt}from"./cloneDeep.0f109ce3.js";import{d as Nt}from"./debounce.a43f57fe.js";import"./index.d8dfc1ef.js";import"./isEqual.f785ded9.js";import"./_Uint8Array.4a2b558d.js";import"./_baseGet.57648035.js";import"./isArray.3fa80ba1.js";import"./isObject.5a18b265.js";import"./_arrayPush.6d7e61e4.js";import"./_isIndex.f5af1eca.js";import"./pick.b27c0e8e.js";import"./_baseSet.39436bc7.js";import"./_defineProperty.f71786e5.js";import"./flatten.a5c62c9e.js";import"./_baseFlatten.02332558.js";import"./_overRest.e23153e9.js";import"./install.eb991fcc.js";import"./index.08c2d09f.js";import"./rand.0e47716b.js";import"./strings.bdfeda91.js";import"./arrays.952da6c6.js";import"./scroll.2b6fcfe4.js";import"./style.63c3403a.js";import"./browser.d1f1569e.js";import"./icon.577a7726.js";import"./typescript.c44ade1c.js";import"./index.a9f5a16d.js";import"./size.007424cf.js";import"./constants.e2ce9b61.js";import"./index.2837b29c.js";import"./index.e0cee20e.js";import"./focus-trap.daca3e80.js";import"./event.079378dc.js";import"./util.c8753e63.js";import"./get.070bcf83.js";import"./_baseClone.00ccee08.js";import"./_initCloneObject.90ccc272.js";const Vt=gt({...it,size:ht,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:Ne(Function),default:(s,q)=>s.text.includes(q)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:Ne(Function),default:()=>!0},popperClass:{type:String,default:""},teleported:ct.teleported,tagType:{...dt.type,default:"info"},validateEvent:{type:Boolean,default:!0}}),$t={[$e]:s=>!!s||s===null,[Ie]:s=>!!s||s===null,focus:s=>s instanceof FocusEvent,blur:s=>s instanceof FocusEvent,visibleChange:s=>bt(s),expandChange:s=>!!s,removeTag:s=>!!s},It={key:0},Bt=["placeholder","onKeydown"],Dt=["onClick"],Ft="ElCascader",zt=Ve({name:Ft}),Mt=Ve({...zt,props:Vt,emits:$t,setup(s,{expose:q,emit:S}){const r=s,Be={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:e})=>{const{modifiersData:t,placement:l}=e;["right","left","bottom","top"].includes(l)||(t.arrow.x=35)},requires:["arrow"]}]},pe=Xe();let V=0,U=0;const n=Se("cascader"),j=Se("input"),{t:de}=Ct(),{form:fe,formItem:ve}=kt(),G=c(null),$=c(null),me=c(null),d=c(null),M=c(null),g=c(!1),Q=c(!1),C=c(!1),X=c(!1),K=c(""),_=c(""),P=c([]),Z=c([]),J=c([]),A=c(!1),De=u(()=>pe.style),k=u(()=>r.disabled||(fe==null?void 0:fe.disabled)),ge=u(()=>r.placeholder||de("el.cascader.placeholder")),Fe=u(()=>_.value||P.value.length>0||A.value?"":ge.value),L=Tt(),he=u(()=>["small"].includes(L.value)?"small":"default"),T=u(()=>!!r.props.multiple),be=u(()=>!r.filterable||T.value),ye=u(()=>T.value?_.value:K.value),O=u(()=>{var e;return((e=d.value)==null?void 0:e.checkedNodes)||[]}),ze=u(()=>!r.clearable||k.value||C.value||!Q.value?!1:!!O.value.length),Y=u(()=>{const{showAllLevels:e,separator:t}=r,l=O.value;return l.length?T.value?"":l[0].calcText(e,t):""}),ee=u({get(){return xt(r.modelValue)},set(e){S($e,e),S(Ie,e),r.validateEvent&&(ve==null||ve.validate("change").catch(t=>wt()))}}),Me=u(()=>[n.b(),n.m(L.value),n.is("disabled",k.value),pe.class]),Ke=u(()=>[j.e("icon"),"icon-arrow-down",n.is("reverse",g.value)]),Ae=u(()=>n.is("focus",g.value||X.value)),Ce=u(()=>{var e,t;return(t=(e=G.value)==null?void 0:e.popperRef)==null?void 0:t.contentRef}),p=e=>{var t,l,a;k.value||(e=e!=null?e:!g.value,e!==g.value&&(g.value=e,(l=(t=$.value)==null?void 0:t.input)==null||l.setAttribute("aria-expanded",`${e}`),e?(I(),N((a=d.value)==null?void 0:a.scrollToExpandingNode)):r.filterable&&se(),S("visibleChange",e)))},I=()=>{N(()=>{var e;(e=G.value)==null||e.updatePopper()})},te=()=>{C.value=!1},le=e=>{const{showAllLevels:t,separator:l}=r;return{node:e,key:e.uid,text:e.calcText(t,l),hitState:!1,closable:!k.value&&!e.isDisabled,isCollapseTag:!1}},oe=e=>{var t;const l=e.node;l.doCheck(!1),(t=d.value)==null||t.calculateCheckedValue(),S("removeTag",l.valueByOption)},Le=()=>{if(!T.value)return;const e=O.value,t=[],l=[];if(e.forEach(a=>l.push(le(a))),Z.value=l,e.length){const[a,...h]=e,b=h.length;t.push(le(a)),b&&(r.collapseTags?t.push({key:-1,text:`+ ${b}`,closable:!1,isCollapseTag:!0}):h.forEach(f=>t.push(le(f))))}P.value=t},ke=()=>{var e,t;const{filterMethod:l,showAllLevels:a,separator:h}=r,b=(t=(e=d.value)==null?void 0:e.getFlattedNodes(!r.props.checkStrictly))==null?void 0:t.filter(f=>f.isDisabled?!1:(f.calcText(a,h),l(f,ye.value)));T.value&&(P.value.forEach(f=>{f.hitState=!1}),Z.value.forEach(f=>{f.hitState=!1})),C.value=!0,J.value=b,I()},Oe=()=>{var e;let t;C.value&&M.value?t=M.value.$el.querySelector(`.${n.e("suggestion-item")}`):t=(e=d.value)==null?void 0:e.$el.querySelector(`.${n.b("node")}[tabindex="-1"]`),t&&(t.focus(),!C.value&&t.click())},ae=()=>{var e,t;const l=(e=$.value)==null?void 0:e.input,a=me.value,h=(t=M.value)==null?void 0:t.$el;if(!(!at||!l)){if(h){const b=h.querySelector(`.${n.e("suggestion-list")}`);b.style.minWidth=`${l.offsetWidth}px`}if(a){const{offsetHeight:b}=a,f=P.value.length>0?`${Math.max(b+6,V)}px`:`${V}px`;l.style.height=f,I()}}},Re=e=>{var t;return(t=d.value)==null?void 0:t.getCheckedNodes(e)},He=e=>{I(),S("expandChange",e)},x=e=>{var t;const l=(t=e.target)==null?void 0:t.value;if(e.type==="compositionend")A.value=!1,N(()=>ne(l));else{const a=l[l.length-1]||"";A.value=!Et(a)}},We=e=>{if(!A.value)switch(e.code){case E.enter:p();break;case E.down:p(!0),N(Oe),e.preventDefault();break;case E.esc:g.value===!0&&(e.preventDefault(),e.stopPropagation(),p(!1));break;case E.tab:p(!1);break}},qe=()=>{var e;(e=d.value)==null||e.clearCheckedNodes(),!g.value&&r.filterable&&se(),p(!1)},se=()=>{const{value:e}=Y;K.value=e,_.value=e},Ue=e=>{var t,l;const{checked:a}=e;T.value?(t=d.value)==null||t.handleCheckChange(e,!a,!1):(!a&&((l=d.value)==null||l.handleCheckChange(e,!0,!1)),p(!1))},je=e=>{const t=e.target,{code:l}=e;switch(l){case E.up:case E.down:{const a=l===E.up?-1:1;St(_t(t,a,`.${n.e("suggestion-item")}[tabindex="-1"]`));break}case E.enter:t.click();break}},Ge=()=>{const e=P.value,t=e[e.length-1];U=_.value?0:U+1,!(!t||!U||r.collapseTags&&e.length>1)&&(t.hitState?oe(t):t.hitState=!0)},Te=e=>{const t=e.target,l=n.e("search-input");t.className===l&&(X.value=!0),S("focus",e)},we=e=>{X.value=!1,S("blur",e)},Qe=Nt(()=>{const{value:e}=ye;if(!e)return;const t=r.beforeFilter(e);Ze(t)?t.then(ke).catch(()=>{}):t!==!1?ke():te()},r.debounce),ne=(e,t)=>{!g.value&&p(!0),!(t!=null&&t.isComposing)&&(e?Qe():te())},Ee=e=>Number.parseFloat(nt(j.cssVarName("input-height"),e).value)-2;return B(C,I),B([O,k],Le),B(P,()=>{N(()=>ae())}),B(L,async()=>{await N();const e=$.value.input;V=Ee(e)||V,ae()}),B(Y,se,{immediate:!0}),Je(()=>{const e=$.value.input,t=Ee(e);V=e.offsetHeight||t,st(e,ae)}),q({getCheckedNodes:Re,cascaderPanelRef:d,togglePopperVisible:p,contentRef:Ce}),(e,t)=>(i(),w(o(Pe),{ref_key:"tooltipRef",ref:G,visible:g.value,teleported:e.teleported,"popper-class":[o(n).e("dropdown"),e.popperClass],"popper-options":Be,"fallback-placements":["bottom-start","bottom","top-start","top","right","left"],"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:"bottom-start",transition:`${o(n).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:"",onHide:te},{default:v(()=>[R((i(),y("div",{class:m(o(Me)),style:Ye(o(De)),onClick:t[5]||(t[5]=()=>p(o(be)?void 0:!0)),onKeydown:We,onMouseenter:t[6]||(t[6]=l=>Q.value=!0),onMouseleave:t[7]||(t[7]=l=>Q.value=!1)},[D(o(ut),{ref_key:"input",ref:$,modelValue:K.value,"onUpdate:modelValue":t[1]||(t[1]=l=>K.value=l),placeholder:o(Fe),readonly:o(be),disabled:o(k),"validate-event":!1,size:o(L),class:m(o(Ae)),tabindex:o(T)&&e.filterable&&!o(k)?-1:void 0,onCompositionstart:x,onCompositionupdate:x,onCompositionend:x,onFocus:Te,onBlur:we,onInput:ne},{suffix:v(()=>[o(ze)?(i(),w(o(ce),{key:"clear",class:m([o(j).e("icon"),"icon-circle-close"]),onClick:re(qe,["stop"])},{default:v(()=>[D(o(ft))]),_:1},8,["class","onClick"])):(i(),w(o(ce),{key:"arrow-down",class:m(o(Ke)),onClick:t[0]||(t[0]=re(l=>p(),["stop"]))},{default:v(()=>[D(o(vt))]),_:1},8,["class"]))]),_:1},8,["modelValue","placeholder","readonly","disabled","size","class","tabindex"]),o(T)?(i(),y("div",{key:0,ref_key:"tagWrapper",ref:me,class:m(o(n).e("tags"))},[(i(!0),y(ie,null,ue(P.value,l=>(i(),w(o(xe),{key:l.key,type:e.tagType,size:o(he),hit:l.hitState,closable:l.closable,"disable-transitions":"",onClose:a=>oe(l)},{default:v(()=>[l.isCollapseTag===!1?(i(),y("span",It,F(l.text),1)):(i(),w(o(Pe),{key:1,disabled:g.value||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:v(()=>[z("span",null,F(l.text),1)]),content:v(()=>[z("div",{class:m(o(n).e("collapse-tags"))},[(i(!0),y(ie,null,ue(Z.value.slice(1),(a,h)=>(i(),y("div",{key:h,class:m(o(n).e("collapse-tag"))},[(i(),w(o(xe),{key:a.key,class:"in-tooltip",type:e.tagType,size:o(he),hit:a.hitState,closable:a.closable,"disable-transitions":"",onClose:b=>oe(a)},{default:v(()=>[z("span",null,F(a.text),1)]),_:2},1032,["type","size","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","hit","closable","onClose"]))),128)),e.filterable&&!o(k)?R((i(),y("input",{key:0,"onUpdate:modelValue":t[2]||(t[2]=l=>_.value=l),type:"text",class:m(o(n).e("search-input")),placeholder:o(Y)?"":o(ge),onInput:t[3]||(t[3]=l=>ne(_.value,l)),onClick:t[4]||(t[4]=re(l=>p(!0),["stop"])),onKeydown:et(Ge,["delete"]),onCompositionstart:x,onCompositionupdate:x,onCompositionend:x,onFocus:Te,onBlur:we},null,42,Bt)),[[tt,_.value]]):H("v-if",!0)],2)):H("v-if",!0)],38)),[[o(Pt),()=>p(!1),o(Ce)]])]),content:v(()=>[R(D(o(rt),{ref_key:"cascaderPanelRef",ref:d,modelValue:o(ee),"onUpdate:modelValue":t[8]||(t[8]=l=>lt(ee)?ee.value=l:null),options:e.options,props:r.props,border:!1,"render-label":e.$slots.default,onExpandChange:He,onClose:t[9]||(t[9]=l=>e.$nextTick(()=>p(!1)))},null,8,["modelValue","options","props","render-label"]),[[_e,!C.value]]),e.filterable?R((i(),w(o(pt),{key:0,ref_key:"suggestionPanel",ref:M,tag:"ul",class:m(o(n).e("suggestion-panel")),"view-class":o(n).e("suggestion-list"),onKeydown:je},{default:v(()=>[J.value.length?(i(!0),y(ie,{key:0},ue(J.value,l=>(i(),y("li",{key:l.uid,class:m([o(n).e("suggestion-item"),o(n).is("checked",l.checked)]),tabindex:-1,onClick:a=>Ue(l)},[z("span",null,F(l.text),1),l.checked?(i(),w(o(ce),{key:0},{default:v(()=>[D(o(mt))]),_:1})):H("v-if",!0)],10,Dt))),128)):ot(e.$slots,"empty",{key:1},()=>[z("li",{class:m(o(n).e("empty-text"))},F(o(de)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[_e,C.value]]):H("v-if",!0)]),_:3},8,["visible","teleported","popper-class","transition"]))}});var W=yt(Mt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader/src/cascader.vue"]]);W.install=s=>{s.component(W.name,W)};const Kt=W,Wl=Kt;export{Wl as ElCascader,$t as cascaderEmits,Vt as cascaderProps,Kt as default};
