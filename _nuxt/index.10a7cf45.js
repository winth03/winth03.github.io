import{f as he,a2 as se,o as y,D as w,Q as $,a4 as g,R as H,I as E,K as ve,aK as B,a5 as Mt,p as M,k as h,w as J,S as L,u as ce,a6 as Ze,aa as oe,as as ae,aw as Le,M as $e,e as P,H as kt,aU as zt,t as Xe,a3 as Nt,r as fe,b2 as Je,Z as me,L as z,Y as W,X as ne,W as Ne,c as G,aQ as F,P as Be,$ as Bt,n as Lt,g as $t}from"./entry.40f94ce2.js";import{u as Kt,E as Dt}from"./index.0becfcd2.js";import{ElTag as Rt}from"./index.b3d93e3d.js";import{ElIcon as At}from"./index.52232a07.js";import{_ as Ke}from"./plugin-vue_export-helper.b0b5f2d9.js";import{g as Ht}from"./index.cd7da693.js";import{CircleClose as Ft,ArrowUp as Ut}from"./index.e0b44930.js";import{i as Pt}from"./validator.f60c176b.js";import{d as Wt}from"./runtime.a8d5aa72.js";import{a as Gt,i as xe}from"./types.0ffe2429.js";import{E as jt}from"./aria.362daa0e.js";import{c as Qt,F as qt}from"./fixed-size-list.e3c49844.js";import{l as _e,A as et,C as tt,E as Yt,f as Zt,D as Xt,h as Jt}from"./scrollbar.3e720c3e.js";import{g as K}from"./get.070bcf83.js";import{u as xt}from"./index.5dbd068b.js";import{i as _t}from"./i18n.de31208d.js";import{u as el}from"./index.b1f4efad.js";import{u as tl}from"./use-form-item.eeb4683c.js";import{V as ll}from"./icon.aaa9d058.js";import{e as nl}from"./strings.c93dd47f.js";import{u as ol}from"./use-form-common-props.c0d2009e.js";import{U as st,C as it}from"./event.e54e7e4a.js";import{d as al}from"./error.6c36bb34.js";import{d as sl}from"./debounce.a43f57fe.js";import{i as lt}from"./isEqual.f785ded9.js";import{C as il}from"./index.4cc18b4f.js";import"./event.079378dc.js";import"./install.db378abc.js";import"./size.007424cf.js";import"./style.a7bf22e4.js";import"./constants.e2ce9b61.js";import"./index.f72caa6f.js";import"./index.1eb5ee59.js";import"./focus-trap.efed23b5.js";import"./raf.961fe51d.js";import"./browser.d39506a1.js";import"./_baseGet.57648035.js";import"./isArray.3fa80ba1.js";import"./isObject.5a18b265.js";import"./typescript.c44ade1c.js";import"./util.c8753e63.js";import"./_Uint8Array.4a2b558d.js";import"./_arrayPush.6d7e61e4.js";import"./_isIndex.f5af1eca.js";const x=(e,l,s)=>{const{itemSize:i}=e,{items:r,lastVisitedIndex:p}=s;if(l>p){let u=0;if(p>=0){const n=r[p];u=n.offset+n.size}for(let n=p+1;n<=l;n++){const S=i(n);r[n]={offset:u,size:S},u+=S}s.lastVisitedIndex=l}return r[l]},rl=(e,l,s)=>{const{items:i,lastVisitedIndex:r}=l;return(r>0?i[r].offset:0)>=s?rt(e,l,0,r,s):ul(e,l,Math.max(0,r),s)},rt=(e,l,s,i,r)=>{for(;s<=i;){const p=s+Math.floor((i-s)/2),u=x(e,p,l).offset;if(u===r)return p;u<r?s=p+1:u>r&&(i=p-1)}return Math.max(0,s-1)},ul=(e,l,s,i)=>{const{total:r}=e;let p=1;for(;s<r&&x(e,s,l).offset<i;)s+=p,p*=2;return rt(e,l,Math.floor(s/2),Math.min(s,r-1),i)},nt=({total:e},{items:l,estimatedItemSize:s,lastVisitedIndex:i})=>{let r=0;if(i>=e&&(i=e-1),i>=0){const n=l[i];r=n.offset+n.size}const u=(e-i-1)*s;return r+u},dl=Qt({name:"ElDynamicSizeList",getItemOffset:(e,l,s)=>x(e,l,s).offset,getItemSize:(e,l,{items:s})=>s[l].size,getEstimatedTotalSize:nt,getOffset:(e,l,s,i,r)=>{const{height:p,layout:u,width:n}=e,S=_e(u)?n:p,O=x(e,l,r),b=nt(e,r),f=Math.max(0,Math.min(b-S,O.offset)),o=Math.max(0,O.offset-S+O.size);switch(s===Jt&&(i>=o-S&&i<=f+S?s=et:s=tt),s){case Zt:return f;case Yt:return o;case tt:return Math.round(o+(f-o)/2);case et:default:return i>=o&&i<=f?i:i<o?o:f}},getStartIndexForOffset:(e,l,s)=>rl(e,s,l),getStopIndexForStartIndex:(e,l,s,i)=>{const{height:r,total:p,layout:u,width:n}=e,S=_e(u)?n:r,O=x(e,l,i),b=s+S;let f=O.offset+O.size,o=l;for(;o<p-1&&f<b;)o++,f+=x(e,o,i).size;return o},initCache({estimatedItemSize:e=Xt},l){const s={items:{},estimatedItemSize:e,lastVisitedIndex:-1};return s.clearCacheAfterIndex=(i,r=!0)=>{var p,u;s.lastVisitedIndex=Math.min(s.lastVisitedIndex,i-1),(p=l.exposed)==null||p.getItemStyleCache(-1),r&&((u=l.proxy)==null||u.$forceUpdate())},s},clearCache:!1,validateProps:({itemSize:e})=>{}}),pl=he({props:{item:{type:Object,required:!0},style:Object,height:Number},setup(){return{ns:se("select")}}});function cl(e,l,s,i,r,p){return e.item.isTitle?(y(),w("div",{key:0,class:g(e.ns.be("group","title")),style:H([e.style,{lineHeight:`${e.height}px`}])},$(e.item.label),7)):(y(),w("div",{key:1,class:g(e.ns.be("group","split")),style:H(e.style)},[E("span",{class:g(e.ns.be("group","split-dash")),style:H({top:`${e.height/2}px`})},null,6)],6))}var fl=Ke(pl,[["render",cl],["__file","/home/runner/work/element-plus/element-plus/packages/components/select-v2/src/group-item.vue"]]);function ml(e,{emit:l}){return{hoverItem:()=>{e.disabled||l("hover",e.index)},selectOptionClick:()=>{e.disabled||l("select",e.item,e.index)}}}const vl={allowCreate:Boolean,autocomplete:{type:String,default:"none"},automaticDropdown:Boolean,clearable:Boolean,clearIcon:{type:[String,Object],default:Ft},effect:{type:String,default:"light"},collapseTags:Boolean,collapseTagsTooltip:{type:Boolean,default:!1},maxCollapseTags:{type:Number,default:1},defaultFirstOption:Boolean,disabled:Boolean,estimatedOptionHeight:{type:Number,default:void 0},filterable:Boolean,filterMethod:Function,height:{type:Number,default:170},itemHeight:{type:Number,default:34},id:String,loading:Boolean,loadingText:String,label:String,modelValue:[Array,String,Number,Boolean,Object],multiple:Boolean,multipleLimit:{type:Number,default:0},name:String,noDataText:String,noMatchText:String,remoteMethod:Function,reserveKeyword:{type:Boolean,default:!0},options:{type:Array,required:!0},placeholder:{type:String},teleported:Kt.teleported,persistent:{type:Boolean,default:!0},popperClass:{type:String,default:""},popperOptions:{type:Object,default:()=>({})},remote:Boolean,size:{type:String,validator:Pt},valueKey:{type:String,default:"value"},scrollbarAlwaysOn:{type:Boolean,default:!1},validateEvent:{type:Boolean,default:!0},placement:{type:Wt(String),values:Ht,default:"bottom-start"}},gl={data:Array,disabled:Boolean,hovering:Boolean,item:Object,index:Number,style:Object,selected:Boolean,created:Boolean},hl=he({props:gl,emits:["select","hover"],setup(e,{emit:l}){const s=se("select"),{hoverItem:i,selectOptionClick:r}=ml(e,{emit:l});return{ns:s,hoverItem:i,selectOptionClick:r}}}),bl=["aria-selected"];function yl(e,l,s,i,r,p){return y(),w("li",{"aria-selected":e.selected,style:H(e.style),class:g([e.ns.be("dropdown","option-item"),e.ns.is("selected",e.selected),e.ns.is("disabled",e.disabled),e.ns.is("created",e.created),{hover:e.hovering}]),onMouseenter:l[0]||(l[0]=(...u)=>e.hoverItem&&e.hoverItem(...u)),onClick:l[1]||(l[1]=B((...u)=>e.selectOptionClick&&e.selectOptionClick(...u),["stop"]))},[ve(e.$slots,"default",{item:e.item,index:e.index,disabled:e.disabled},()=>[E("span",null,$(e.item.label),1)])],46,bl)}var Sl=Ke(hl,[["render",yl],["__file","/home/runner/work/element-plus/element-plus/packages/components/select-v2/src/option-item.vue"]]);const ut=Symbol("ElSelectV2Injection");var Vl=he({name:"ElSelectDropdown",props:{data:{type:Array,required:!0},hoveringIndex:Number,width:Number},setup(e,{slots:l,expose:s}){const i=Mt(ut),r=se("select"),p=M([]),u=M(),n=h(()=>e.data.length);J(()=>n.value,()=>{var c,m;(m=(c=i.popper.value).updatePopper)==null||m.call(c)});const S=h(()=>Gt(i.props.estimatedOptionHeight)),O=h(()=>S.value?{itemSize:i.props.itemHeight}:{estimatedSize:i.props.estimatedOptionHeight,itemSize:c=>p.value[c]}),b=(c=[],m)=>{const{props:{valueKey:V}}=i;return oe(m)?c&&c.some(k=>K(k,V)===K(m,V)):c.includes(m)},f=(c,m)=>{if(oe(m)){const{valueKey:V}=i.props;return K(c,V)===K(m,V)}else return c===m},o=(c,m)=>{const{valueKey:V}=i.props;return i.props.multiple?b(c,K(m,V)):f(c,K(m,V))},T=(c,m)=>{const{disabled:V,multiple:k,multipleLimit:I}=i.props;return V||!m&&(k?I>0&&c.length>=I:!1)},j=c=>e.hoveringIndex===c;s({listRef:u,isSized:S,isItemDisabled:T,isItemHovering:j,isItemSelected:o,scrollToItem:c=>{const m=u.value;m&&m.scrollToItem(c)},resetScrollTop:()=>{const c=u.value;c&&c.resetScrollTop()}});const C=c=>{const{index:m,data:V,style:k}=c,I=ce(S),{itemSize:N,estimatedSize:Q}=ce(O),{modelValue:q}=i.props,{onSelect:re,onHover:Ve}=i,D=V[m];if(D.type==="Group")return L(fl,{item:D,style:k,height:I?N:Q},null);const ue=o(q,D),Ie=T(q,ue),Ce=j(m);return L(Sl,Ze(c,{selected:ue,disabled:D.disabled||Ie,created:!!D.created,hovering:Ce,item:D,onSelect:re,onHover:Ve}),{default:we=>{var te;return((te=l.default)==null?void 0:te.call(l,we))||L("span",null,[D.label])}})},{onKeyboardNavigate:U,onKeyboardSelect:be}=i,ee=()=>{U("forward")},ye=()=>{U("backward")},ie=()=>{i.expanded=!1},Se=c=>{const{code:m}=c,{tab:V,esc:k,down:I,up:N,enter:Q}=jt;switch(m!==V&&(c.preventDefault(),c.stopPropagation()),m){case V:case k:{ie();break}case I:{ee();break}case N:{ye();break}case Q:{be();break}}};return()=>{var c;const{data:m,width:V}=e,{height:k,multiple:I,scrollbarAlwaysOn:N}=i.props;if(m.length===0)return L("div",{class:r.b("dropdown"),style:{width:`${V}px`}},[(c=l.empty)==null?void 0:c.call(l)]);const Q=ce(S)?qt:dl;return L("div",{class:[r.b("dropdown"),r.is("multiple",I)]},[L(Q,Ze({ref:u},ce(O),{className:r.be("dropdown","list"),scrollbarAlwaysOn:N,data:m,height:k,width:V,total:m.length,onKeydown:Se}),{default:q=>L(C,q,null)})])}}});function Il(e,l){const s=M(0),i=M(null),r=h(()=>e.allowCreate&&e.filterable);function p(b){const f=o=>o.value===b;return e.options&&e.options.some(f)||l.createdOptions.some(f)}function u(b){!r.value||(e.multiple&&b.created?s.value++:i.value=b)}function n(b){if(r.value)if(b&&b.length>0&&!p(b)){const f={value:b,label:b,created:!0,disabled:!1};l.createdOptions.length>=s.value?l.createdOptions[s.value]=f:l.createdOptions.push(f)}else if(e.multiple)l.createdOptions.length=s.value;else{const f=i.value;l.createdOptions.length=0,f&&f.created&&l.createdOptions.push(f)}}function S(b){if(!r.value||!b||!b.created||b.created&&e.reserveKeyword&&l.inputValue===b.label)return;const f=l.createdOptions.findIndex(o=>o.value===b.value);~f&&(l.createdOptions.splice(f,1),s.value--)}function O(){r.value&&(l.createdOptions.length=0,s.value=0)}return{createNewOption:n,removeNewOption:S,selectNewOption:u,clearAllNewOption:O}}const Cl=e=>{const l=[];return e.forEach(s=>{ae(s.options)?(l.push({label:s.label,isTitle:!0,type:"Group"}),s.options.forEach(i=>{l.push(i)}),l.push({type:"Group"})):l.push(s)}),l};function wl(e){const l=M(!1);return{handleCompositionStart:()=>{l.value=!0},handleCompositionUpdate:p=>{const u=p.target.value,n=u[u.length-1]||"";l.value=!_t(n)},handleCompositionEnd:p=>{l.value&&(l.value=!1,Le(e)&&e(p))}}}const ot="",at=11,Ol={larget:51,default:42,small:33},Tl=(e,l)=>{const{t:s}=el(),i=se("select-v2"),r=se("input"),{form:p,formItem:u}=tl(),n=$e({inputValue:ot,displayInputValue:ot,calculatedWidth:0,cachedPlaceholder:"",cachedOptions:[],createdOptions:[],createdLabel:"",createdSelected:!1,currentPlaceholder:"",hoveringIndex:-1,comboBoxHovering:!1,isOnComposition:!1,isSilentBlur:!1,isComposing:!1,inputLength:20,selectWidth:200,initialInputHeight:0,previousQuery:null,previousValue:void 0,query:"",selectedLabel:"",softFocus:!1,tagInMultiLine:!1}),S=M(-1),O=M(-1),b=M(null),f=M(null),o=M(null),T=M(null),j=M(null),_=M(null),X=M(null),C=M(!1),U=h(()=>e.disabled||(p==null?void 0:p.disabled)),be=h(()=>{const t=I.value.length*34;return t>e.height?e.height:t}),ee=h(()=>!xe(e.modelValue)),ye=h(()=>{const t=e.multiple?Array.isArray(e.modelValue)&&e.modelValue.length>0:ee.value;return e.clearable&&!U.value&&n.comboBoxHovering&&t}),ie=h(()=>e.remote&&e.filterable?"":Ut),Se=h(()=>ie.value&&i.is("reverse",C.value)),c=h(()=>(u==null?void 0:u.validateState)||""),m=h(()=>ll[c.value]),V=h(()=>e.remote?300:0),k=h(()=>{const t=I.value;return e.loading?e.loadingText||s("el.select.loading"):e.remote&&n.inputValue===""&&t.length===0?!1:e.filterable&&n.inputValue&&t.length>0?e.noMatchText||s("el.select.noMatch"):t.length===0?e.noDataText||s("el.select.noData"):null}),I=h(()=>{const t=a=>{const d=n.inputValue,v=new RegExp(nl(d),"i");return d?v.test(a.label||""):!0};return e.loading?[]:Cl(e.options.concat(n.createdOptions).map(a=>{if(ae(a.options)){const d=a.options.filter(t);if(d.length>0)return{...a,options:d}}else if(e.remote||t(a))return a;return null}).filter(a=>a!==null))}),N=h(()=>{const t=new Map;return I.value.forEach((a,d)=>{t.set(Y(a),{option:a,index:d})}),t}),Q=h(()=>I.value.every(t=>t.disabled)),q=ol(),re=h(()=>q.value==="small"?"small":"default"),Ve=h(()=>{const t=_.value,a=re.value||"default",d=t?Number.parseInt(getComputedStyle(t).paddingLeft):0,v=t?Number.parseInt(getComputedStyle(t).paddingRight):0;return n.selectWidth-v-d-Ol[a]}),D=()=>{var t;O.value=((t=j.value)==null?void 0:t.offsetWidth)||200},ue=h(()=>({width:`${n.calculatedWidth===0?at:Math.ceil(n.calculatedWidth)+at}px`})),Ie=h(()=>ae(e.modelValue)?e.modelValue.length===0&&!n.displayInputValue:e.filterable?n.displayInputValue.length===0:!0),Ce=h(()=>{const t=e.placeholder||s("el.select.placeholder");return e.multiple||xe(e.modelValue)?t:n.selectedLabel}),we=h(()=>{var t,a;return(a=(t=T.value)==null?void 0:t.popperRef)==null?void 0:a.contentRef}),te=h(()=>{if(e.multiple){const t=e.modelValue.length;if(e.modelValue.length>0&&N.value.has(e.modelValue[t-1])){const{index:a}=N.value.get(e.modelValue[t-1]);return a}}else if(e.modelValue&&N.value.has(e.modelValue)){const{index:t}=N.value.get(e.modelValue);return t}return-1}),De=h({get(){return C.value&&k.value!==!1},set(t){C.value=t}}),dt=h(()=>n.cachedOptions.slice(0,e.maxCollapseTags)),pt=h(()=>n.cachedOptions.slice(e.maxCollapseTags)),{createNewOption:Re,removeNewOption:Oe,selectNewOption:Ae,clearAllNewOption:Te}=Il(e,n),{handleCompositionStart:ct,handleCompositionUpdate:ft,handleCompositionEnd:mt}=wl(t=>Ye(t)),He=()=>{var t,a,d;(a=(t=f.value)==null?void 0:t.focus)==null||a.call(t),(d=T.value)==null||d.updatePopper()},Ee=()=>{if(!e.automaticDropdown&&!U.value)return n.isComposing&&(n.softFocus=!0),P(()=>{var t,a;C.value=!C.value,(a=(t=f.value)==null?void 0:t.focus)==null||a.call(t)})},Fe=()=>(e.filterable&&n.inputValue!==n.selectedLabel&&(n.query=n.selectedLabel),Pe(n.inputValue),P(()=>{Re(n.inputValue)})),Ue=sl(Fe,V.value),Pe=t=>{n.previousQuery!==t&&(n.previousQuery=t,e.filterable&&Le(e.filterMethod)?e.filterMethod(t):e.filterable&&e.remote&&Le(e.remoteMethod)&&e.remoteMethod(t))},vt=t=>{lt(e.modelValue,t)||l(it,t)},le=t=>{l(st,t),vt(t),n.previousValue=t==null?void 0:t.toString()},gt=(t=[],a)=>{if(!oe(a))return t.indexOf(a);const d=e.valueKey;let v=-1;return t.some((R,A)=>K(R,d)===K(a,d)?(v=A,!0):!1),v},Y=t=>oe(t)?K(t,e.valueKey):t,ht=t=>oe(t)?t.label:t,Me=()=>P(()=>{var t,a;if(!f.value)return;const d=_.value;j.value.height=d.offsetHeight,C.value&&k.value!==!1&&((a=(t=T.value)==null?void 0:t.updatePopper)==null||a.call(t))}),We=()=>{var t,a;if(bt(),D(),(a=(t=T.value)==null?void 0:t.updatePopper)==null||a.call(t),e.multiple)return Me()},bt=()=>{const t=_.value;t&&(n.selectWidth=t.getBoundingClientRect().width)},Ge=(t,a,d=!0)=>{var v,R;if(e.multiple){let A=e.modelValue.slice();const pe=gt(A,Y(t));pe>-1?(A=[...A.slice(0,pe),...A.slice(pe+1)],n.cachedOptions.splice(pe,1),Oe(t)):(e.multipleLimit<=0||A.length<e.multipleLimit)&&(A=[...A,Y(t)],n.cachedOptions.push(t),Ae(t),Z(a)),le(A),t.created&&(n.query="",Pe(""),n.inputLength=20),e.filterable&&!e.reserveKeyword&&((R=(v=f.value).focus)==null||R.call(v),de("")),e.filterable&&(n.calculatedWidth=X.value.getBoundingClientRect().width),Me(),Ot()}else S.value=a,n.selectedLabel=t.label,le(Y(t)),C.value=!1,n.isComposing=!1,n.isSilentBlur=d,Ae(t),t.created||Te(),Z(a)},yt=(t,a)=>{const{valueKey:d}=e,v=e.modelValue.indexOf(K(a,d));if(v>-1&&!U.value){const R=[...e.modelValue.slice(0,v),...e.modelValue.slice(v+1)];return n.cachedOptions.splice(v,1),le(R),l("remove-tag",K(a,d)),n.softFocus=!0,Oe(a),P(He)}t.stopPropagation()},St=t=>{const a=n.isComposing;n.isComposing=!0,n.softFocus?n.softFocus=!1:a||l("focus",t)},je=t=>(n.softFocus=!1,P(()=>{var a,d;(d=(a=f.value)==null?void 0:a.blur)==null||d.call(a),X.value&&(n.calculatedWidth=X.value.getBoundingClientRect().width),n.isSilentBlur?n.isSilentBlur=!1:n.isComposing&&l("blur",t),n.isComposing=!1})),Vt=()=>{n.displayInputValue.length>0?de(""):C.value=!1},It=t=>{if(n.displayInputValue.length===0){t.preventDefault();const a=e.modelValue.slice();a.pop(),Oe(n.cachedOptions.pop()),le(a)}},Ct=()=>{let t;return ae(e.modelValue)?t=[]:t=void 0,n.softFocus=!0,e.multiple?n.cachedOptions=[]:n.selectedLabel="",C.value=!1,le(t),l("clear"),Te(),P(He)},de=t=>{n.displayInputValue=t,n.inputValue=t},Qe=(t,a=void 0)=>{const d=I.value;if(!["forward","backward"].includes(t)||U.value||d.length<=0||Q.value)return;if(!C.value)return Ee();a===void 0&&(a=n.hoveringIndex);let v=-1;t==="forward"?(v=a+1,v>=d.length&&(v=0)):t==="backward"&&(v=a-1,(v<0||v>=d.length)&&(v=d.length-1));const R=d[v];if(R.disabled||R.type==="Group")return Qe(t,v);Z(v),ke(v)},wt=()=>{if(C.value)~n.hoveringIndex&&I.value[n.hoveringIndex]&&Ge(I.value[n.hoveringIndex],n.hoveringIndex,!1);else return Ee()},Z=t=>{n.hoveringIndex=t},qe=()=>{n.hoveringIndex=-1},Ot=()=>{var t;const a=f.value;a&&((t=a.focus)==null||t.call(a))},Ye=t=>{const a=t.target.value;if(de(a),n.displayInputValue.length>0&&!C.value&&(C.value=!0),n.calculatedWidth=X.value.getBoundingClientRect().width,e.multiple&&Me(),e.remote)Ue();else return Fe()},Tt=()=>(C.value=!1,je()),Et=()=>(n.inputValue=n.displayInputValue,P(()=>{~te.value&&(Z(te.value),ke(n.hoveringIndex))})),ke=t=>{o.value.scrollToItem(t)},ze=()=>{if(qe(),e.multiple)if(e.modelValue.length>0){let t=!1;n.cachedOptions.length=0,n.previousValue=e.modelValue.toString();for(const a of e.modelValue)if(N.value.has(a)){const{index:d,option:v}=N.value.get(a);n.cachedOptions.push(v),t||Z(d),t=!0}}else n.cachedOptions=[],n.previousValue=void 0;else if(ee.value){n.previousValue=e.modelValue;const t=I.value,a=t.findIndex(d=>Y(d)===Y(e.modelValue));~a?(n.selectedLabel=t[a].label,Z(a)):n.selectedLabel=`${e.modelValue}`}else n.selectedLabel="",n.previousValue=void 0;Te(),D()};return J(C,t=>{var a,d;l("visible-change",t),t?(d=(a=T.value).update)==null||d.call(a):(n.displayInputValue="",n.previousQuery=null,Re(""))}),J(()=>e.modelValue,(t,a)=>{var d;(!t||t.toString()!==n.previousValue)&&ze(),!lt(t,a)&&e.validateEvent&&((d=u==null?void 0:u.validate)==null||d.call(u,"change").catch(v=>al()))},{deep:!0}),J(()=>e.options,()=>{const t=f.value;(!t||t&&document.activeElement!==t)&&ze()},{deep:!0}),J(I,()=>P(o.value.resetScrollTop)),J(()=>De.value,t=>{t||qe()}),kt(()=>{ze()}),xt(j,We),{collapseTagSize:re,currentPlaceholder:Ce,expanded:C,emptyText:k,popupHeight:be,debounce:V,filteredOptions:I,iconComponent:ie,iconReverse:Se,inputWrapperStyle:ue,popperSize:O,dropdownMenuVisible:De,hasModelValue:ee,shouldShowPlaceholder:Ie,selectDisabled:U,selectSize:q,showClearBtn:ye,states:n,tagMaxWidth:Ve,nsSelectV2:i,nsInput:r,calculatorRef:X,controlRef:b,inputRef:f,menuRef:o,popper:T,selectRef:j,selectionRef:_,popperRef:we,validateState:c,validateIcon:m,showTagList:dt,collapseTagList:pt,debouncedOnInputChange:Ue,deleteTag:yt,getLabel:ht,getValueKey:Y,handleBlur:je,handleClear:Ct,handleClickOutside:Tt,handleDel:It,handleEsc:Vt,handleFocus:St,handleMenuEnter:Et,handleResize:We,toggleMenu:Ee,scrollTo:ke,onInput:Ye,onKeyboardNavigate:Qe,onKeyboardSelect:wt,onSelect:Ge,onHover:Z,onUpdateInputValue:de,handleCompositionStart:ct,handleCompositionEnd:mt,handleCompositionUpdate:ft}},El=he({name:"ElSelectV2",components:{ElSelectMenu:Vl,ElTag:Rt,ElTooltip:Dt,ElIcon:At},directives:{ClickOutside:il,ModelText:zt},props:vl,emits:[st,it,"remove-tag","clear","visible-change","focus","blur"],setup(e,{emit:l}){const s=h(()=>{const{modelValue:r,multiple:p}=e,u=p?[]:void 0;return ae(r)?p?r:u:p?u:r}),i=Tl($e({...Xe(e),modelValue:s}),l);return Nt(ut,{props:$e({...Xe(e),height:i.popupHeight,modelValue:s}),popper:i.popper,onSelect:i.onSelect,onHover:i.onHover,onKeyboardNavigate:i.onKeyboardNavigate,onKeyboardSelect:i.onKeyboardSelect}),{...i,modelValue:s}}}),Ml={key:0},kl=["id","autocomplete","aria-expanded","aria-labelledby","disabled","readonly","name","unselectable"],zl=["textContent"],Nl=["id","aria-labelledby","aria-expanded","autocomplete","disabled","name","readonly","unselectable"],Bl=["textContent"];function Ll(e,l,s,i,r,p){const u=fe("el-tag"),n=fe("el-tooltip"),S=fe("el-icon"),O=fe("el-select-menu"),b=Je("model-text"),f=Je("click-outside");return me((y(),w("div",{ref:"selectRef",class:g([e.nsSelectV2.b(),e.nsSelectV2.m(e.selectSize)]),onClick:l[24]||(l[24]=B((...o)=>e.toggleMenu&&e.toggleMenu(...o),["stop"])),onMouseenter:l[25]||(l[25]=o=>e.states.comboBoxHovering=!0),onMouseleave:l[26]||(l[26]=o=>e.states.comboBoxHovering=!1)},[L(n,{ref:"popper",visible:e.dropdownMenuVisible,teleported:e.teleported,"popper-class":[e.nsSelectV2.e("popper"),e.popperClass],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"popper-options":e.popperOptions,"fallback-placements":["bottom-start","top-start","right","left"],effect:e.effect,placement:e.placement,pure:"",transition:`${e.nsSelectV2.namespace.value}-zoom-in-top`,trigger:"click",persistent:e.persistent,onBeforeShow:e.handleMenuEnter,onHide:l[23]||(l[23]=o=>e.states.inputValue=e.states.displayInputValue)},{default:z(()=>[E("div",{ref:"selectionRef",class:g([e.nsSelectV2.e("wrapper"),e.nsSelectV2.is("focused",e.states.isComposing||e.expanded),e.nsSelectV2.is("hovering",e.states.comboBoxHovering),e.nsSelectV2.is("filterable",e.filterable),e.nsSelectV2.is("disabled",e.selectDisabled)])},[e.$slots.prefix?(y(),w("div",Ml,[ve(e.$slots,"prefix")])):W("v-if",!0),e.multiple?(y(),w("div",{key:1,class:g(e.nsSelectV2.e("selection"))},[e.collapseTags&&e.modelValue.length>0?(y(),w(ne,{key:0},[(y(!0),w(ne,null,Ne(e.showTagList,o=>(y(),w("div",{key:e.getValueKey(o),class:g(e.nsSelectV2.e("selected-item"))},[L(u,{closable:!e.selectDisabled&&!(o!=null&&o.disable),size:e.collapseTagSize,type:"info","disable-transitions":"",onClose:T=>e.deleteTag(T,o)},{default:z(()=>[E("span",{class:g(e.nsSelectV2.e("tags-text")),style:H({maxWidth:`${e.tagMaxWidth}px`})},$(o==null?void 0:o.label),7)]),_:2},1032,["closable","size","onClose"])],2))),128)),E("div",{class:g(e.nsSelectV2.e("selected-item"))},[e.modelValue.length>e.maxCollapseTags?(y(),G(u,{key:0,closable:!1,size:e.collapseTagSize,type:"info","disable-transitions":""},{default:z(()=>[e.collapseTagsTooltip?(y(),G(n,{key:0,disabled:e.dropdownMenuVisible,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:!1},{default:z(()=>[E("span",{class:g(e.nsSelectV2.e("tags-text")),style:H({maxWidth:`${e.tagMaxWidth}px`})},"+ "+$(e.modelValue.length-e.maxCollapseTags),7)]),content:z(()=>[E("div",{class:g(e.nsSelectV2.e("selection"))},[(y(!0),w(ne,null,Ne(e.collapseTagList,o=>(y(),w("div",{key:e.getValueKey(o),class:g(e.nsSelectV2.e("selected-item"))},[L(u,{closable:!e.selectDisabled&&!o.disabled,size:e.collapseTagSize,class:"in-tooltip",type:"info","disable-transitions":"",onClose:T=>e.deleteTag(T,o)},{default:z(()=>[E("span",{class:g(e.nsSelectV2.e("tags-text")),style:H({maxWidth:`${e.tagMaxWidth}px`})},$(e.getLabel(o)),7)]),_:2},1032,["closable","size","onClose"])],2))),128))],2)]),_:1},8,["disabled","effect"])):(y(),w("span",{key:1,class:g(e.nsSelectV2.e("tags-text")),style:H({maxWidth:`${e.tagMaxWidth}px`})},"+ "+$(e.modelValue.length-e.maxCollapseTags),7))]),_:1},8,["size"])):W("v-if",!0)],2)],64)):(y(!0),w(ne,{key:1},Ne(e.states.cachedOptions,o=>(y(),w("div",{key:e.getValueKey(o),class:g(e.nsSelectV2.e("selected-item"))},[L(u,{closable:!e.selectDisabled&&!o.disabled,size:e.collapseTagSize,type:"info","disable-transitions":"",onClose:T=>e.deleteTag(T,o)},{default:z(()=>[E("span",{class:g(e.nsSelectV2.e("tags-text")),style:H({maxWidth:`${e.tagMaxWidth}px`})},$(e.getLabel(o)),7)]),_:2},1032,["closable","size","onClose"])],2))),128)),E("div",{class:g([e.nsSelectV2.e("selected-item"),e.nsSelectV2.e("input-wrapper")]),style:H(e.inputWrapperStyle)},[me(E("input",{id:e.id,ref:"inputRef",autocomplete:e.autocomplete,"aria-autocomplete":"list","aria-haspopup":"listbox",autocapitalize:"off","aria-expanded":e.expanded,"aria-labelledby":e.label,class:g([e.nsSelectV2.is(e.selectSize),e.nsSelectV2.e("combobox-input")]),disabled:e.disabled,role:"combobox",readonly:!e.filterable,spellcheck:"false",type:"text",name:e.name,unselectable:e.expanded?"on":void 0,"onUpdate:modelValue":l[0]||(l[0]=(...o)=>e.onUpdateInputValue&&e.onUpdateInputValue(...o)),onFocus:l[1]||(l[1]=(...o)=>e.handleFocus&&e.handleFocus(...o)),onBlur:l[2]||(l[2]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onInput:l[3]||(l[3]=(...o)=>e.onInput&&e.onInput(...o)),onCompositionstart:l[4]||(l[4]=(...o)=>e.handleCompositionStart&&e.handleCompositionStart(...o)),onCompositionupdate:l[5]||(l[5]=(...o)=>e.handleCompositionUpdate&&e.handleCompositionUpdate(...o)),onCompositionend:l[6]||(l[6]=(...o)=>e.handleCompositionEnd&&e.handleCompositionEnd(...o)),onKeydown:[l[7]||(l[7]=F(B(o=>e.onKeyboardNavigate("backward"),["stop","prevent"]),["up"])),l[8]||(l[8]=F(B(o=>e.onKeyboardNavigate("forward"),["stop","prevent"]),["down"])),l[9]||(l[9]=F(B((...o)=>e.onKeyboardSelect&&e.onKeyboardSelect(...o),["stop","prevent"]),["enter"])),l[10]||(l[10]=F(B((...o)=>e.handleEsc&&e.handleEsc(...o),["stop","prevent"]),["esc"])),l[11]||(l[11]=F(B((...o)=>e.handleDel&&e.handleDel(...o),["stop"]),["delete"]))]},null,42,kl),[[b,e.states.displayInputValue]]),e.filterable?(y(),w("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:g(e.nsSelectV2.e("input-calculator")),textContent:$(e.states.displayInputValue)},null,10,zl)):W("v-if",!0)],6)],2)):(y(),w(ne,{key:2},[E("div",{class:g([e.nsSelectV2.e("selected-item"),e.nsSelectV2.e("input-wrapper")])},[me(E("input",{id:e.id,ref:"inputRef","aria-autocomplete":"list","aria-haspopup":"listbox","aria-labelledby":e.label,"aria-expanded":e.expanded,autocapitalize:"off",autocomplete:e.autocomplete,class:g(e.nsSelectV2.e("combobox-input")),disabled:e.disabled,name:e.name,role:"combobox",readonly:!e.filterable,spellcheck:"false",type:"text",unselectable:e.expanded?"on":void 0,onCompositionstart:l[12]||(l[12]=(...o)=>e.handleCompositionStart&&e.handleCompositionStart(...o)),onCompositionupdate:l[13]||(l[13]=(...o)=>e.handleCompositionUpdate&&e.handleCompositionUpdate(...o)),onCompositionend:l[14]||(l[14]=(...o)=>e.handleCompositionEnd&&e.handleCompositionEnd(...o)),onFocus:l[15]||(l[15]=(...o)=>e.handleFocus&&e.handleFocus(...o)),onBlur:l[16]||(l[16]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onInput:l[17]||(l[17]=(...o)=>e.onInput&&e.onInput(...o)),onKeydown:[l[18]||(l[18]=F(B(o=>e.onKeyboardNavigate("backward"),["stop","prevent"]),["up"])),l[19]||(l[19]=F(B(o=>e.onKeyboardNavigate("forward"),["stop","prevent"]),["down"])),l[20]||(l[20]=F(B((...o)=>e.onKeyboardSelect&&e.onKeyboardSelect(...o),["stop","prevent"]),["enter"])),l[21]||(l[21]=F(B((...o)=>e.handleEsc&&e.handleEsc(...o),["stop","prevent"]),["esc"]))],"onUpdate:modelValue":l[22]||(l[22]=(...o)=>e.onUpdateInputValue&&e.onUpdateInputValue(...o))},null,42,Nl),[[b,e.states.displayInputValue]])],2),e.filterable?(y(),w("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:g([e.nsSelectV2.e("selected-item"),e.nsSelectV2.e("input-calculator")]),textContent:$(e.states.displayInputValue)},null,10,Bl)):W("v-if",!0)],64)),e.shouldShowPlaceholder?(y(),w("span",{key:3,class:g([e.nsSelectV2.e("placeholder"),e.nsSelectV2.is("transparent",e.multiple?e.modelValue.length===0:!e.hasModelValue)])},$(e.currentPlaceholder),3)):W("v-if",!0),E("span",{class:g(e.nsSelectV2.e("suffix"))},[e.iconComponent?me((y(),G(S,{key:0,class:g([e.nsSelectV2.e("caret"),e.nsInput.e("icon"),e.iconReverse])},{default:z(()=>[(y(),G(Be(e.iconComponent)))]),_:1},8,["class"])),[[Bt,!e.showClearBtn]]):W("v-if",!0),e.showClearBtn&&e.clearIcon?(y(),G(S,{key:1,class:g([e.nsSelectV2.e("caret"),e.nsInput.e("icon")]),onClick:B(e.handleClear,["prevent","stop"])},{default:z(()=>[(y(),G(Be(e.clearIcon)))]),_:1},8,["class","onClick"])):W("v-if",!0),e.validateState&&e.validateIcon?(y(),G(S,{key:2,class:g([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:z(()=>[(y(),G(Be(e.validateIcon)))]),_:1},8,["class"])):W("v-if",!0)],2)],2)]),content:z(()=>[L(O,{ref:"menuRef",data:e.filteredOptions,width:e.popperSize,"hovering-index":e.states.hoveringIndex,"scrollbar-always-on":e.scrollbarAlwaysOn},{default:z(o=>[ve(e.$slots,"default",Lt($t(o)))]),empty:z(()=>[ve(e.$slots,"empty",{},()=>[E("p",{class:g(e.nsSelectV2.e("empty"))},$(e.emptyText?e.emptyText:""),3)])]),_:3},8,["data","width","hovering-index","scrollbar-always-on"])]),_:3},8,["visible","teleported","popper-class","popper-options","effect","placement","transition","persistent","onBeforeShow"])],34)),[[f,e.handleClickOutside,e.popperRef]])}var ge=Ke(El,[["render",Ll],["__file","/home/runner/work/element-plus/element-plus/packages/components/select-v2/src/select.vue"]]);ge.install=e=>{e.component(ge.name,ge)};const $l=ge,Tn=$l;export{Tn as ElSelectV2,$l as default,ut as selectV2InjectionKey};
