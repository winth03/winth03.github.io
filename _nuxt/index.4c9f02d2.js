import{f as $e,aI as Xe,a2 as Se,p as c,k as u,aT as Ye,w as D,e as N,H as Ze,o as i,c as w,L as v,Z as L,D as y,a4 as m,u as l,R as Je,S as B,aK as re,X as ie,W as ue,Q as F,I as z,aQ as et,aU as tt,Y as O,ag as at,$ as _e,K as lt,aj as ot}from"./entry.40f94ce2.js";import{u as st,g as nt}from"./index.5dbd068b.js";import rt,{CommonProps as it}from"./index.563ac9d5.js";import{ElInput as ut}from"./index.ecd8b7b6.js";import{u as ct,E as Pe}from"./index.0becfcd2.js";import{ElScrollbar as pt}from"./index.8ce59d4c.js";import{tagProps as dt,ElTag as xe}from"./index.b3d93e3d.js";import{ElIcon as ce}from"./index.52232a07.js";import{CircleClose as ft,ArrowDown as vt,Check as mt}from"./index.e0b44930.js";import{b as gt,d as Ne}from"./runtime.a8d5aa72.js";import{a as ht}from"./index.f72caa6f.js";import{U as Ve,C as Ie}from"./event.e54e7e4a.js";import{b as bt}from"./types.0ffe2429.js";import{_ as yt}from"./plugin-vue_export-helper.b0b5f2d9.js";import{u as Ct}from"./index.b1f4efad.js";import{u as kt}from"./use-form-item.eeb4683c.js";import{u as Tt}from"./use-form-common-props.c0d2009e.js";import{d as wt}from"./error.6c36bb34.js";import{i as Et}from"./i18n.de31208d.js";import{E}from"./aria.362daa0e.js";import{f as St,g as _t}from"./aria.46c29a86.js";import{C as Pt}from"./index.4cc18b4f.js";import{c as xt}from"./cloneDeep.0f109ce3.js";import{d as Nt}from"./debounce.a43f57fe.js";import"./index.b287272e.js";import"./isEqual.f785ded9.js";import"./_Uint8Array.4a2b558d.js";import"./_baseGet.57648035.js";import"./isArray.3fa80ba1.js";import"./isObject.5a18b265.js";import"./_arrayPush.6d7e61e4.js";import"./_isIndex.f5af1eca.js";import"./pick.b27c0e8e.js";import"./_baseSet.39436bc7.js";import"./_defineProperty.f71786e5.js";import"./flatten.a5c62c9e.js";import"./_baseFlatten.02332558.js";import"./_overRest.e23153e9.js";import"./install.db378abc.js";import"./index.f42115ab.js";import"./rand.0e47716b.js";import"./strings.c93dd47f.js";import"./arrays.952da6c6.js";import"./scroll.123f6305.js";import"./style.a7bf22e4.js";import"./browser.d39506a1.js";import"./icon.aaa9d058.js";import"./typescript.c44ade1c.js";import"./index.43dcf301.js";import"./size.007424cf.js";import"./constants.e2ce9b61.js";import"./index.cd7da693.js";import"./index.1eb5ee59.js";import"./focus-trap.efed23b5.js";import"./event.079378dc.js";import"./util.c8753e63.js";import"./get.070bcf83.js";import"./_baseClone.00ccee08.js";import"./_initCloneObject.90ccc272.js";const $t=gt({...it,size:ht,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:Ne(Function),default:(s,U)=>s.text.includes(U)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:Ne(Function),default:()=>!0},popperClass:{type:String,default:""},teleported:ct.teleported,tagType:{...dt.type,default:"info"},validateEvent:{type:Boolean,default:!0}}),Vt={[Ve]:s=>!!s||s===null,[Ie]:s=>!!s||s===null,focus:s=>s instanceof FocusEvent,blur:s=>s instanceof FocusEvent,visibleChange:s=>bt(s),expandChange:s=>!!s,removeTag:s=>!!s},It={key:0},Dt=["placeholder","onKeydown"],Bt=["onClick"],Ft="ElCascader",zt=$e({name:Ft}),Kt=$e({...zt,props:$t,emits:Vt,setup(s,{expose:U,emit:S}){const r=s,De={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:e})=>{const{modifiersData:t,placement:a}=e;["right","left","bottom","top"].includes(a)||(t.arrow.x=35)},requires:["arrow"]}]},pe=Xe();let $=0,q=0;const n=Se("cascader"),Q=Se("input"),{t:de}=Ct(),{form:fe,formItem:ve}=kt(),j=c(null),V=c(null),me=c(null),d=c(null),K=c(null),g=c(!1),G=c(!1),C=c(!1),X=c(!1),M=c(""),_=c(""),P=c([]),Y=c([]),Z=c([]),A=c(!1),Be=u(()=>pe.style),k=u(()=>r.disabled||(fe==null?void 0:fe.disabled)),ge=u(()=>r.placeholder||de("el.cascader.placeholder")),Fe=u(()=>_.value||P.value.length>0||A.value?"":ge.value),R=Tt(),he=u(()=>["small"].includes(R.value)?"small":"default"),T=u(()=>!!r.props.multiple),be=u(()=>!r.filterable||T.value),ye=u(()=>T.value?_.value:M.value),H=u(()=>{var e;return((e=d.value)==null?void 0:e.checkedNodes)||[]}),ze=u(()=>!r.clearable||k.value||C.value||!G.value?!1:!!H.value.length),J=u(()=>{const{showAllLevels:e,separator:t}=r,a=H.value;return a.length?T.value?"":a[0].calcText(e,t):""}),ee=u({get(){return xt(r.modelValue)},set(e){S(Ve,e),S(Ie,e),r.validateEvent&&(ve==null||ve.validate("change").catch(t=>wt()))}}),Ke=u(()=>[n.b(),n.m(R.value),n.is("disabled",k.value),pe.class]),Me=u(()=>[Q.e("icon"),"icon-arrow-down",n.is("reverse",g.value)]),Ae=u(()=>n.is("focus",g.value||X.value)),Ce=u(()=>{var e,t;return(t=(e=j.value)==null?void 0:e.popperRef)==null?void 0:t.contentRef}),p=e=>{var t,a,o;k.value||(e=e!=null?e:!g.value,e!==g.value&&(g.value=e,(a=(t=V.value)==null?void 0:t.input)==null||a.setAttribute("aria-expanded",`${e}`),e?(I(),N((o=d.value)==null?void 0:o.scrollToExpandingNode)):r.filterable&&se(),S("visibleChange",e)))},I=()=>{N(()=>{var e;(e=j.value)==null||e.updatePopper()})},te=()=>{C.value=!1},ae=e=>{const{showAllLevels:t,separator:a}=r;return{node:e,key:e.uid,text:e.calcText(t,a),hitState:!1,closable:!k.value&&!e.isDisabled,isCollapseTag:!1}},le=e=>{var t;const a=e.node;a.doCheck(!1),(t=d.value)==null||t.calculateCheckedValue(),S("removeTag",a.valueByOption)},Re=()=>{if(!T.value)return;const e=H.value,t=[],a=[];if(e.forEach(o=>a.push(ae(o))),Y.value=a,e.length){const[o,...h]=e,b=h.length;t.push(ae(o)),b&&(r.collapseTags?t.push({key:-1,text:`+ ${b}`,closable:!1,isCollapseTag:!0}):h.forEach(f=>t.push(ae(f))))}P.value=t},ke=()=>{var e,t;const{filterMethod:a,showAllLevels:o,separator:h}=r,b=(t=(e=d.value)==null?void 0:e.getFlattedNodes(!r.props.checkStrictly))==null?void 0:t.filter(f=>f.isDisabled?!1:(f.calcText(o,h),a(f,ye.value)));T.value&&(P.value.forEach(f=>{f.hitState=!1}),Y.value.forEach(f=>{f.hitState=!1})),C.value=!0,Z.value=b,I()},He=()=>{var e;let t;C.value&&K.value?t=K.value.$el.querySelector(`.${n.e("suggestion-item")}`):t=(e=d.value)==null?void 0:e.$el.querySelector(`.${n.b("node")}[tabindex="-1"]`),t&&(t.focus(),!C.value&&t.click())},oe=()=>{var e,t;const a=(e=V.value)==null?void 0:e.input,o=me.value,h=(t=K.value)==null?void 0:t.$el;if(!(!ot||!a)){if(h){const b=h.querySelector(`.${n.e("suggestion-list")}`);b.style.minWidth=`${a.offsetWidth}px`}if(o){const{offsetHeight:b}=o,f=P.value.length>0?`${Math.max(b+6,$)}px`:`${$}px`;a.style.height=f,I()}}},Le=e=>{var t;return(t=d.value)==null?void 0:t.getCheckedNodes(e)},Oe=e=>{I(),S("expandChange",e)},x=e=>{var t;const a=(t=e.target)==null?void 0:t.value;if(e.type==="compositionend")A.value=!1,N(()=>ne(a));else{const o=a[a.length-1]||"";A.value=!Et(o)}},We=e=>{if(!A.value)switch(e.code){case E.enter:p();break;case E.down:p(!0),N(He),e.preventDefault();break;case E.esc:g.value===!0&&(e.preventDefault(),e.stopPropagation(),p(!1));break;case E.tab:p(!1);break}},Ue=()=>{var e;(e=d.value)==null||e.clearCheckedNodes(),!g.value&&r.filterable&&se(),p(!1)},se=()=>{const{value:e}=J;M.value=e,_.value=e},qe=e=>{var t,a;const{checked:o}=e;T.value?(t=d.value)==null||t.handleCheckChange(e,!o,!1):(!o&&((a=d.value)==null||a.handleCheckChange(e,!0,!1)),p(!1))},Qe=e=>{const t=e.target,{code:a}=e;switch(a){case E.up:case E.down:{const o=a===E.up?-1:1;St(_t(t,o,`.${n.e("suggestion-item")}[tabindex="-1"]`));break}case E.enter:t.click();break}},je=()=>{const e=P.value,t=e[e.length-1];q=_.value?0:q+1,!(!t||!q||r.collapseTags&&e.length>1)&&(t.hitState?le(t):t.hitState=!0)},Te=e=>{const t=e.target,a=n.e("search-input");t.className===a&&(X.value=!0),S("focus",e)},we=e=>{X.value=!1,S("blur",e)},Ge=Nt(()=>{const{value:e}=ye;if(!e)return;const t=r.beforeFilter(e);Ye(t)?t.then(ke).catch(()=>{}):t!==!1?ke():te()},r.debounce),ne=(e,t)=>{!g.value&&p(!0),!(t!=null&&t.isComposing)&&(e?Ge():te())},Ee=e=>Number.parseFloat(nt(Q.cssVarName("input-height"),e).value)-2;return D(C,I),D([H,k],Re),D(P,()=>{N(()=>oe())}),D(R,async()=>{await N();const e=V.value.input;$=Ee(e)||$,oe()}),D(J,se,{immediate:!0}),Ze(()=>{const e=V.value.input,t=Ee(e);$=e.offsetHeight||t,st(e,oe)}),U({getCheckedNodes:Le,cascaderPanelRef:d,togglePopperVisible:p,contentRef:Ce}),(e,t)=>(i(),w(l(Pe),{ref_key:"tooltipRef",ref:j,visible:g.value,teleported:e.teleported,"popper-class":[l(n).e("dropdown"),e.popperClass],"popper-options":De,"fallback-placements":["bottom-start","bottom","top-start","top","right","left"],"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:"bottom-start",transition:`${l(n).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:"",onHide:te},{default:v(()=>[L((i(),y("div",{class:m(l(Ke)),style:Je(l(Be)),onClick:t[5]||(t[5]=()=>p(l(be)?void 0:!0)),onKeydown:We,onMouseenter:t[6]||(t[6]=a=>G.value=!0),onMouseleave:t[7]||(t[7]=a=>G.value=!1)},[B(l(ut),{ref_key:"input",ref:V,modelValue:M.value,"onUpdate:modelValue":t[1]||(t[1]=a=>M.value=a),placeholder:l(Fe),readonly:l(be),disabled:l(k),"validate-event":!1,size:l(R),class:m(l(Ae)),tabindex:l(T)&&e.filterable&&!l(k)?-1:void 0,onCompositionstart:x,onCompositionupdate:x,onCompositionend:x,onFocus:Te,onBlur:we,onInput:ne},{suffix:v(()=>[l(ze)?(i(),w(l(ce),{key:"clear",class:m([l(Q).e("icon"),"icon-circle-close"]),onClick:re(Ue,["stop"])},{default:v(()=>[B(l(ft))]),_:1},8,["class","onClick"])):(i(),w(l(ce),{key:"arrow-down",class:m(l(Me)),onClick:t[0]||(t[0]=re(a=>p(),["stop"]))},{default:v(()=>[B(l(vt))]),_:1},8,["class"]))]),_:1},8,["modelValue","placeholder","readonly","disabled","size","class","tabindex"]),l(T)?(i(),y("div",{key:0,ref_key:"tagWrapper",ref:me,class:m(l(n).e("tags"))},[(i(!0),y(ie,null,ue(P.value,a=>(i(),w(l(xe),{key:a.key,type:e.tagType,size:l(he),hit:a.hitState,closable:a.closable,"disable-transitions":"",onClose:o=>le(a)},{default:v(()=>[a.isCollapseTag===!1?(i(),y("span",It,F(a.text),1)):(i(),w(l(Pe),{key:1,disabled:g.value||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:v(()=>[z("span",null,F(a.text),1)]),content:v(()=>[z("div",{class:m(l(n).e("collapse-tags"))},[(i(!0),y(ie,null,ue(Y.value.slice(1),(o,h)=>(i(),y("div",{key:h,class:m(l(n).e("collapse-tag"))},[(i(),w(l(xe),{key:o.key,class:"in-tooltip",type:e.tagType,size:l(he),hit:o.hitState,closable:o.closable,"disable-transitions":"",onClose:b=>le(o)},{default:v(()=>[z("span",null,F(o.text),1)]),_:2},1032,["type","size","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","hit","closable","onClose"]))),128)),e.filterable&&!l(k)?L((i(),y("input",{key:0,"onUpdate:modelValue":t[2]||(t[2]=a=>_.value=a),type:"text",class:m(l(n).e("search-input")),placeholder:l(J)?"":l(ge),onInput:t[3]||(t[3]=a=>ne(_.value,a)),onClick:t[4]||(t[4]=re(a=>p(!0),["stop"])),onKeydown:et(je,["delete"]),onCompositionstart:x,onCompositionupdate:x,onCompositionend:x,onFocus:Te,onBlur:we},null,42,Dt)),[[tt,_.value]]):O("v-if",!0)],2)):O("v-if",!0)],38)),[[l(Pt),()=>p(!1),l(Ce)]])]),content:v(()=>[L(B(l(rt),{ref_key:"cascaderPanelRef",ref:d,modelValue:l(ee),"onUpdate:modelValue":t[8]||(t[8]=a=>at(ee)?ee.value=a:null),options:e.options,props:r.props,border:!1,"render-label":e.$slots.default,onExpandChange:Oe,onClose:t[9]||(t[9]=a=>e.$nextTick(()=>p(!1)))},null,8,["modelValue","options","props","render-label"]),[[_e,!C.value]]),e.filterable?L((i(),w(l(pt),{key:0,ref_key:"suggestionPanel",ref:K,tag:"ul",class:m(l(n).e("suggestion-panel")),"view-class":l(n).e("suggestion-list"),onKeydown:Qe},{default:v(()=>[Z.value.length?(i(!0),y(ie,{key:0},ue(Z.value,a=>(i(),y("li",{key:a.uid,class:m([l(n).e("suggestion-item"),l(n).is("checked",a.checked)]),tabindex:-1,onClick:o=>qe(a)},[z("span",null,F(a.text),1),a.checked?(i(),w(l(ce),{key:0},{default:v(()=>[B(l(mt))]),_:1})):O("v-if",!0)],10,Bt))),128)):lt(e.$slots,"empty",{key:1},()=>[z("li",{class:m(l(n).e("empty-text"))},F(l(de)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[_e,C.value]]):O("v-if",!0)]),_:3},8,["visible","teleported","popper-class","transition"]))}});var W=yt(Kt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader/src/cascader.vue"]]);W.install=s=>{s.component(W.name,W)};const Mt=W,Wa=Mt;export{Wa as ElCascader,Vt as cascaderEmits,$t as cascaderProps,Mt as default};
